INFO:train_dqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_dqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_dqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_dqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_dqn_vecnorm:Entrenando DQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento DQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 42
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 128
  gamma: 0.99
  n_steps: 3
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/dqn_variants/dqn_batch_big/seed_42/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 33.5     |
|    ep_rew_mean      | 69       |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3196     |
|    time_elapsed     | 0        |
|    total_timesteps  | 272      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 36.2     |
|    ep_rew_mean      | 144      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8328     |
|    fps              | 498      |
|    time_elapsed     | 601      |
|    total_timesteps  | 300000   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.0194   |
|    n_updates        | 74998    |
----------------------------------
INFO:train_dqn_vecnorm:Modelo guardado en best/dqn_variants/dqn_batch_big/seed_42/best/dqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/dqn_variants/dqn_batch_big/seed_42/best/dqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/dqn_variants/dqn_batch_big/seed_42/best/dqn_yahtzee_vecnorm_model, stats=best/dqn_variants/dqn_batch_big/seed_42/best/dqn_yahtzee_vecnorm_stats.pkl, algo=dqn
INFO:final_evaluate_rl:Cargando modelo: best/dqn_variants/dqn_batch_big/seed_42/best/dqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: dqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 108.25700089661404, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 110.04299942264333, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 154.36550033977255, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 151.83049731934443, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 195.9930008277297, Puntuacion final: 198.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 156.54300031531602, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 122.54500140016899, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 126.14249962836038, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 141.86599902668968, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 170.11399719875772, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 164.52299962891266, Puntuacion final: 166.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 183.81599859695416, Puntuacion final: 185.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 175.9040014129132, Puntuacion final: 178.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 162.60800161445513, Puntuacion final: 164.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 146.60149997717235, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 145.21050144801848, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 186.62700072536245, Puntuacion final: 189.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 105.05849903600756, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 183.81750102585647, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 167.62200064526405, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 141.63350254879333, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 163.50900142663158, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 134.5494995721383, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 134.92549928138033, Puntuacion final: 137.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 153.22450057510287, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 115.33550067292526, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 177.82600301370258, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 113.16900086309761, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 162.72649892838672, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 145.93349813809618, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 181.29699971852824, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 138.25000199029455, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 97.38900002464652, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 124.65450137719745, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 169.71849991125055, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 148.35050010238774, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 158.72399794496596, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 185.01350191887468, Puntuacion final: 187.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 139.81800025730627, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 156.72899955429602, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 228.17499848129228, Puntuacion final: 230.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 178.82999808329623, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 154.23199779563583, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 177.1275004472118, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 112.0689985693898, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 173.61249962216243, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 149.85749886056874, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 132.8660015950445, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 188.62100310414098, Puntuacion final: 191.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 146.53699842165224, Puntuacion final: 148.0
INFO:final_evaluate_rl:Metricas guardadas en dqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/dqn_variants/dqn_batch_big/seed_42/best/dqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 152.8838
  Puntuacion final promedio:        154.9600
