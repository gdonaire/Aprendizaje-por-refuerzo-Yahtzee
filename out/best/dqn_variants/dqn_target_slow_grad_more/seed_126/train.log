INFO:train_dqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_dqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_dqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_dqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_dqn_vecnorm:Entrenando DQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento DQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  train_freq: 1
  gradient_steps: 2
  target_update_interval: 30000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/dqn_variants/dqn_target_slow_grad_more/seed_126/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 30.5     |
|    ep_rew_mean      | 49       |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3822     |
|    time_elapsed     | 0        |
|    total_timesteps  | 264      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 34.8     |
|    ep_rew_mean      | 144      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8504     |
|    fps              | 331      |
|    time_elapsed     | 904      |
|    total_timesteps  | 299960   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.0224   |
|    n_updates        | 149976   |
----------------------------------
INFO:train_dqn_vecnorm:Modelo guardado en best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_yahtzee_vecnorm_model, stats=best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_yahtzee_vecnorm_stats.pkl, algo=dqn
INFO:final_evaluate_rl:Cargando modelo: best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: dqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 181.31099853478372, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 167.11199998669326, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 152.5525002385839, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 177.41150028817356, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 135.34299949300475, Puntuacion final: 137.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 127.65000035916455, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 144.2530018677935, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 200.5785003977362, Puntuacion final: 203.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 146.04350063565653, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 166.05900125624612, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 133.85850005294196, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 125.96249921305571, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 131.54299880797043, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 81.90099824324716, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 146.249000164913, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 189.50950086442754, Puntuacion final: 191.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 167.71500019566156, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 133.65499993792037, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 112.8649984986987, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 131.85800037439913, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 176.80850048945285, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 124.44849896000233, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 136.95450240117498, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 177.0090019190684, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 108.20650081359781, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 140.22100001748186, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 73.96000078960788, Puntuacion final: 76.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 147.1385021340684, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 139.84999977331609, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 167.8459981556516, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 145.26149855513358, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 169.55149991397047, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 189.829499586951, Puntuacion final: 191.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 149.74000193784013, Puntuacion final: 152.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 180.7370005697012, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 118.0170009394642, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 174.43300096387975, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 147.81550055672415, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 115.4319999916479, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 171.3089959115605, Puntuacion final: 173.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 115.76949962018989, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 169.03300053905696, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 170.91599817574024, Puntuacion final: 173.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 178.3839983898797, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 145.31150024104863, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 122.64450116758235, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 147.26400149066467, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 174.11599932733225, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 116.02049951255322, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 84.88249860331416, Puntuacion final: 88.0
INFO:final_evaluate_rl:Metricas guardadas en dqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/dqn_variants/dqn_target_slow_grad_more/seed_126/best/dqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 146.6468
  Puntuacion final promedio:        148.7400
