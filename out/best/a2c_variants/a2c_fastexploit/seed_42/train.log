INFO:train_a2c_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_a2c_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_a2c_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_a2c_vecnorm:Entrenando A2C Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 42
  lr: 0.0003
  n_steps: 128
  gamma: 0.995
  ent_coef: 0.01
  gae_lambda: 0.95
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/a2c_ablation/a2c_fastexploit/seed_42/best
  plot_ma_long: 200
Using cpu device
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 34.8     |
|    ep_rew_mean        | 92.9     |
| time/                 |          |
|    fps                | 1940     |
|    iterations         | 100      |
|    time_elapsed       | 52       |
|    total_timesteps    | 102400   |
| train/                |          |
|    entropy_loss       | -3.58    |
|    explained_variance | 0.854    |
|    learning_rate      | 0.0003   |
|    n_updates          | 99       |
|    policy_loss        | 0.366    |
|    value_loss         | 0.171    |
------------------------------------
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 35.9     |
|    ep_rew_mean        | 98.9     |
| time/                 |          |
|    fps                | 1889     |
|    iterations         | 200      |
|    time_elapsed       | 108      |
|    total_timesteps    | 204800   |
| train/                |          |
|    entropy_loss       | -3.58    |
|    explained_variance | 0.85     |
|    learning_rate      | 0.0003   |
|    n_updates          | 199      |
|    policy_loss        | -0.0355  |
|    value_loss         | 0.156    |
------------------------------------
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 36.9     |
|    ep_rew_mean        | 105      |
| time/                 |          |
|    fps                | 1881     |
|    iterations         | 300      |
|    time_elapsed       | 163      |
|    total_timesteps    | 307200   |
| train/                |          |
|    entropy_loss       | -3.5     |
|    explained_variance | 0.899    |
|    learning_rate      | 0.0003   |
|    n_updates          | 299      |
|    policy_loss        | -0.128   |
|    value_loss         | 0.135    |
------------------------------------
INFO:train_a2c_vecnorm:Entrenando A2C Fase 2 por 400000 timesteps...
Using cpu device
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 37.9     |
|    ep_rew_mean        | 107      |
| time/                 |          |
|    fps                | 1884     |
|    iterations         | 100      |
|    time_elapsed       | 108      |
|    total_timesteps    | 204800   |
| train/                |          |
|    entropy_loss       | -3.46    |
|    explained_variance | 0.89     |
|    learning_rate      | 0.0003   |
|    n_updates          | 99       |
|    policy_loss        | -0.0337  |
|    value_loss         | 0.148    |
------------------------------------
INFO:train_a2c_vecnorm:Entrenando A2C Fase 3 por 300000 timesteps...
INFO:train_a2c_vecnorm:Modelo guardado en best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_yahtzee_vecnorm_final y estadisticas de normalizacion en best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_yahtzee_vecnorm_final, stats=best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_vecnorm_stats.pkl, algo=a2c
INFO:final_evaluate_rl:Cargando modelo: best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: a2c
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 144.23100034712115, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 83.33600014075637, Puntuacion final: 86.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 82.85499966668431, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 99.17799968249165, Puntuacion final: 101.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 172.38400239148177, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 113.93949799332768, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 93.87000033725053, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 144.43150124512613, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 119.34249963262118, Puntuacion final: 122.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 113.77800129941897, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 130.14600063022226, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 107.37600175774423, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 102.79400003049523, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 83.40549980988726, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 118.45500034990255, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 127.86499855213333, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 97.9535003072815, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 130.3145004287362, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 131.6664986240212, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 118.75200049381237, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 89.04949961183593, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 100.42349924542941, Puntuacion final: 102.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 108.88299836835358, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 156.23549965425627, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 106.87099833635148, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 118.92549992736895, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 96.37000013969373, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 89.60800063144416, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 107.12449882295914, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 128.2870000912808, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 122.38000043400098, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 165.076000106812, Puntuacion final: 167.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 160.37249966245145, Puntuacion final: 162.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 123.55199969734531, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 96.2984996882733, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 115.92749863665085, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 60.92400004132651, Puntuacion final: 64.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 97.53850026801229, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 111.84699843160342, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 109.86050052708015, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 86.54399865260348, Puntuacion final: 89.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 111.84500030544586, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 91.05299936328083, Puntuacion final: 93.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 154.64400231151376, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 120.56000128365122, Puntuacion final: 122.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 88.66799958632328, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 75.00250089913607, Puntuacion final: 77.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 135.00100073684007, Puntuacion final: 137.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 140.45200140832458, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 127.37549838551786, Puntuacion final: 130.0
INFO:final_evaluate_rl:Metricas guardadas en a2c_vecnorm_final_evaluation_metrics.txt
Using cpu device
Grafica guardada en best/a2c_ablation/a2c_fastexploit/seed_42/best/a2c_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 114.2554
  Puntuacion final promedio:        116.4200
