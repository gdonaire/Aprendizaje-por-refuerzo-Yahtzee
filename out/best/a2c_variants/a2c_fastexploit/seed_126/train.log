INFO:train_a2c_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_a2c_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_a2c_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_a2c_vecnorm:Entrenando A2C Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0003
  n_steps: 128
  gamma: 0.995
  ent_coef: 0.01
  gae_lambda: 0.95
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/a2c_ablation/a2c_fastexploit/seed_126/best
  plot_ma_long: 200
Using cpu device
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 35.2     |
|    ep_rew_mean        | 97.2     |
| time/                 |          |
|    fps                | 1998     |
|    iterations         | 100      |
|    time_elapsed       | 51       |
|    total_timesteps    | 102400   |
| train/                |          |
|    entropy_loss       | -3.59    |
|    explained_variance | 0.829    |
|    learning_rate      | 0.0003   |
|    n_updates          | 99       |
|    policy_loss        | -0.17    |
|    value_loss         | 0.197    |
------------------------------------
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 35.9     |
|    ep_rew_mean        | 96.8     |
| time/                 |          |
|    fps                | 1981     |
|    iterations         | 200      |
|    time_elapsed       | 103      |
|    total_timesteps    | 204800   |
| train/                |          |
|    entropy_loss       | -3.51    |
|    explained_variance | 0.841    |
|    learning_rate      | 0.0003   |
|    n_updates          | 199      |
|    policy_loss        | -0.329   |
|    value_loss         | 0.19     |
------------------------------------
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 36.4     |
|    ep_rew_mean        | 101      |
| time/                 |          |
|    fps                | 1942     |
|    iterations         | 300      |
|    time_elapsed       | 158      |
|    total_timesteps    | 307200   |
| train/                |          |
|    entropy_loss       | -3.55    |
|    explained_variance | 0.863    |
|    learning_rate      | 0.0003   |
|    n_updates          | 299      |
|    policy_loss        | -0.231   |
|    value_loss         | 0.176    |
------------------------------------
INFO:train_a2c_vecnorm:Entrenando A2C Fase 2 por 400000 timesteps...
Using cpu device
------------------------------------
| rollout/              |          |
|    ep_len_mean        | 38.1     |
|    ep_rew_mean        | 105      |
| time/                 |          |
|    fps                | 1947     |
|    iterations         | 100      |
|    time_elapsed       | 105      |
|    total_timesteps    | 204800   |
| train/                |          |
|    entropy_loss       | -3.51    |
|    explained_variance | 0.855    |
|    learning_rate      | 0.0003   |
|    n_updates          | 99       |
|    policy_loss        | 0.0604   |
|    value_loss         | 0.181    |
------------------------------------
INFO:train_a2c_vecnorm:Entrenando A2C Fase 3 por 300000 timesteps...
INFO:train_a2c_vecnorm:Modelo guardado en best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_yahtzee_vecnorm_final y estadisticas de normalizacion en best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_yahtzee_vecnorm_final, stats=best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_vecnorm_stats.pkl, algo=a2c
INFO:final_evaluate_rl:Cargando modelo: best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: a2c
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 122.36399764637463, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 69.16799985105172, Puntuacion final: 71.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 177.7745013399981, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 131.81250080070458, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 84.96950112259947, Puntuacion final: 87.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 126.37650063133333, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 183.89950048335595, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 103.86249911651248, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 169.3014993185643, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 126.74649988912279, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 88.86500008404255, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 168.40250051999465, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 118.34049944765866, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 96.48950067500118, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 159.82849882123992, Puntuacion final: 163.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 124.89850021712482, Puntuacion final: 127.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 92.86750012339326, Puntuacion final: 96.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 116.72099954134319, Puntuacion final: 119.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 132.14099983265623, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 139.46000028244453, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 155.84300104051363, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 108.05549901688937, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 97.8999988171272, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 176.7395001167897, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 93.85049930331297, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 103.34699993079994, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 78.8419995889999, Puntuacion final: 82.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 127.55100037972443, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 56.05950004467741, Puntuacion final: 58.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 67.19149904244114, Puntuacion final: 69.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 113.85850047669373, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 109.57250065915287, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 107.74350031965878, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 88.41750033624703, Puntuacion final: 90.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 82.6770004038699, Puntuacion final: 84.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 156.21950027125422, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 140.0184986857348, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 119.63149988779332, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 90.89800019701943, Puntuacion final: 94.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 123.01699964847649, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 129.04950053431094, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 133.81349920132197, Puntuacion final: 137.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 87.1229999322677, Puntuacion final: 89.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 112.04749882291071, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 89.36600014939904, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 103.47899876511656, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 101.64149887068197, Puntuacion final: 103.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 101.76449865172617, Puntuacion final: 104.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 101.87649997882545, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 101.42949995887466, Puntuacion final: 103.0
INFO:final_evaluate_rl:Metricas guardadas en a2c_vecnorm_final_evaluation_metrics.txt
Using cpu device
Grafica guardada en best/a2c_ablation/a2c_fastexploit/seed_126/best/a2c_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 115.8662
  Puntuacion final promedio:        118.0200
