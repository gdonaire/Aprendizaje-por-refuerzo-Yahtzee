INFO:train_maskablePPO_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_maskablePPO_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_maskablePPO_vecnorm:Usando arquitectura de politica: {'net_arch': {'pi': [256, 256], 'vf': [256, 256]}}
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0003
  n_steps: 2048
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.02
  clip_range: 0.2
  vf_coef: 0.5
  max_grad_norm: 0.5
  policy_arch: {"pi":[256, 256], "vf":[256, 256]}
  eval_episodes: 50
  best_dir: best/mppo_ablation/mppo_baseline/seed_126/best
  plot_ma_long: 200
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 32.4     |
|    ep_rew_mean     | 44.3     |
| time/              |          |
|    fps             | 1940     |
|    iterations      | 1        |
|    time_elapsed    | 8        |
|    total_timesteps | 16384    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.1        |
|    ep_rew_mean          | 48.3        |
| time/                   |             |
|    fps                  | 962         |
|    iterations           | 2           |
|    time_elapsed         | 34          |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.023197275 |
|    clip_fraction        | 0.262       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.05       |
|    explained_variance   | 0.00871     |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0618      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.0265     |
|    value_loss           | 0.269       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.2        |
|    ep_rew_mean          | 55.5        |
| time/                   |             |
|    fps                  | 824         |
|    iterations           | 3           |
|    time_elapsed         | 59          |
|    total_timesteps      | 49152       |
| train/                  |             |
|    approx_kl            | 0.020904154 |
|    clip_fraction        | 0.273       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.02       |
|    explained_variance   | 0.488       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0421      |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0276     |
|    value_loss           | 0.247       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.1        |
|    ep_rew_mean          | 52          |
| time/                   |             |
|    fps                  | 772         |
|    iterations           | 4           |
|    time_elapsed         | 84          |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.020380795 |
|    clip_fraction        | 0.284       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.99       |
|    explained_variance   | 0.649       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0151      |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.03       |
|    value_loss           | 0.244       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.1        |
|    ep_rew_mean          | 61          |
| time/                   |             |
|    fps                  | 745         |
|    iterations           | 5           |
|    time_elapsed         | 109         |
|    total_timesteps      | 81920       |
| train/                  |             |
|    approx_kl            | 0.022515828 |
|    clip_fraction        | 0.297       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.95       |
|    explained_variance   | 0.725       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0102     |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0352     |
|    value_loss           | 0.215       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.2        |
|    ep_rew_mean          | 67.4        |
| time/                   |             |
|    fps                  | 726         |
|    iterations           | 6           |
|    time_elapsed         | 135         |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.022836542 |
|    clip_fraction        | 0.303       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.91       |
|    explained_variance   | 0.744       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00211    |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0385     |
|    value_loss           | 0.203       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 32         |
|    ep_rew_mean          | 70.1       |
| time/                   |            |
|    fps                  | 713        |
|    iterations           | 7          |
|    time_elapsed         | 160        |
|    total_timesteps      | 114688     |
| train/                  |            |
|    approx_kl            | 0.02383243 |
|    clip_fraction        | 0.301      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.85      |
|    explained_variance   | 0.773      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0725    |
|    n_updates            | 60         |
|    policy_gradient_loss | -0.042     |
|    value_loss           | 0.187      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.3        |
|    ep_rew_mean          | 79          |
| time/                   |             |
|    fps                  | 704         |
|    iterations           | 8           |
|    time_elapsed         | 185         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.023807844 |
|    clip_fraction        | 0.304       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.81       |
|    explained_variance   | 0.78        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0202     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0451     |
|    value_loss           | 0.197       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.1        |
|    ep_rew_mean          | 86.7        |
| time/                   |             |
|    fps                  | 697         |
|    iterations           | 9           |
|    time_elapsed         | 211         |
|    total_timesteps      | 147456      |
| train/                  |             |
|    approx_kl            | 0.024240982 |
|    clip_fraction        | 0.303       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.77       |
|    explained_variance   | 0.783       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0166     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0461     |
|    value_loss           | 0.184       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.5        |
|    ep_rew_mean          | 87.7        |
| time/                   |             |
|    fps                  | 693         |
|    iterations           | 10          |
|    time_elapsed         | 236         |
|    total_timesteps      | 163840      |
| train/                  |             |
|    approx_kl            | 0.028722335 |
|    clip_fraction        | 0.332       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.72       |
|    explained_variance   | 0.798       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.067      |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0534     |
|    value_loss           | 0.178       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.6        |
|    ep_rew_mean          | 91          |
| time/                   |             |
|    fps                  | 686         |
|    iterations           | 11          |
|    time_elapsed         | 262         |
|    total_timesteps      | 180224      |
| train/                  |             |
|    approx_kl            | 0.027830534 |
|    clip_fraction        | 0.328       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.68       |
|    explained_variance   | 0.824       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0839     |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0519     |
|    value_loss           | 0.155       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.3        |
|    ep_rew_mean          | 98.3        |
| time/                   |             |
|    fps                  | 682         |
|    iterations           | 12          |
|    time_elapsed         | 288         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.029255807 |
|    clip_fraction        | 0.331       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.64       |
|    explained_variance   | 0.836       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0748     |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0521     |
|    value_loss           | 0.146       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 102         |
| time/                   |             |
|    fps                  | 673         |
|    iterations           | 13          |
|    time_elapsed         | 316         |
|    total_timesteps      | 212992      |
| train/                  |             |
|    approx_kl            | 0.030803103 |
|    clip_fraction        | 0.34        |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.59       |
|    explained_variance   | 0.843       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0912     |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0548     |
|    value_loss           | 0.131       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.8        |
|    ep_rew_mean          | 102         |
| time/                   |             |
|    fps                  | 669         |
|    iterations           | 14          |
|    time_elapsed         | 342         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.032464404 |
|    clip_fraction        | 0.341       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.56       |
|    explained_variance   | 0.859       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0793     |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0558     |
|    value_loss           | 0.122       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 104         |
| time/                   |             |
|    fps                  | 667         |
|    iterations           | 15          |
|    time_elapsed         | 368         |
|    total_timesteps      | 245760      |
| train/                  |             |
|    approx_kl            | 0.033438407 |
|    clip_fraction        | 0.35        |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.53       |
|    explained_variance   | 0.876       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.115      |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0561     |
|    value_loss           | 0.101       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.7        |
|    ep_rew_mean          | 105         |
| time/                   |             |
|    fps                  | 665         |
|    iterations           | 16          |
|    time_elapsed         | 393         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.034487717 |
|    clip_fraction        | 0.349       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.49       |
|    explained_variance   | 0.87        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.116      |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.0566     |
|    value_loss           | 0.106       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.4       |
|    ep_rew_mean          | 111        |
| time/                   |            |
|    fps                  | 665        |
|    iterations           | 17         |
|    time_elapsed         | 418        |
|    total_timesteps      | 278528     |
| train/                  |            |
|    approx_kl            | 0.03616263 |
|    clip_fraction        | 0.348      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.46      |
|    explained_variance   | 0.872      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0888    |
|    n_updates            | 160        |
|    policy_gradient_loss | -0.0563    |
|    value_loss           | 0.108      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 29.7        |
|    ep_rew_mean          | 115         |
| time/                   |             |
|    fps                  | 663         |
|    iterations           | 18          |
|    time_elapsed         | 444         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.036596917 |
|    clip_fraction        | 0.352       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.42       |
|    explained_variance   | 0.862       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0657     |
|    n_updates            | 170         |
|    policy_gradient_loss | -0.0572     |
|    value_loss           | 0.116       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 29.7        |
|    ep_rew_mean          | 116         |
| time/                   |             |
|    fps                  | 662         |
|    iterations           | 19          |
|    time_elapsed         | 469         |
|    total_timesteps      | 311296      |
| train/                  |             |
|    approx_kl            | 0.037762348 |
|    clip_fraction        | 0.353       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.39       |
|    explained_variance   | 0.875       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.067      |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.0571     |
|    value_loss           | 0.105       |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30.6      |
|    ep_rew_mean          | 115       |
| time/                   |           |
|    fps                  | 662       |
|    iterations           | 20        |
|    time_elapsed         | 494       |
|    total_timesteps      | 327680    |
| train/                  |           |
|    approx_kl            | 0.0386393 |
|    clip_fraction        | 0.359     |
|    clip_range           | 0.2       |
|    entropy_loss         | -2.36     |
|    explained_variance   | 0.864     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.111    |
|    n_updates            | 190       |
|    policy_gradient_loss | -0.0596   |
|    value_loss           | 0.12      |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.1       |
|    ep_rew_mean          | 124        |
| time/                   |            |
|    fps                  | 661        |
|    iterations           | 21         |
|    time_elapsed         | 519        |
|    total_timesteps      | 344064     |
| train/                  |            |
|    approx_kl            | 0.03983797 |
|    clip_fraction        | 0.36       |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.35      |
|    explained_variance   | 0.868      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0973    |
|    n_updates            | 200        |
|    policy_gradient_loss | -0.0595    |
|    value_loss           | 0.105      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 29.5        |
|    ep_rew_mean          | 121         |
| time/                   |             |
|    fps                  | 661         |
|    iterations           | 22          |
|    time_elapsed         | 545         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.041541018 |
|    clip_fraction        | 0.358       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.33       |
|    explained_variance   | 0.872       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0723     |
|    n_updates            | 210         |
|    policy_gradient_loss | -0.0597     |
|    value_loss           | 0.11        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.8        |
|    ep_rew_mean          | 124         |
| time/                   |             |
|    fps                  | 659         |
|    iterations           | 23          |
|    time_elapsed         | 570         |
|    total_timesteps      | 376832      |
| train/                  |             |
|    approx_kl            | 0.041984506 |
|    clip_fraction        | 0.367       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.31       |
|    explained_variance   | 0.862       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.103      |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.0607     |
|    value_loss           | 0.115       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.3       |
|    ep_rew_mean          | 123        |
| time/                   |            |
|    fps                  | 659        |
|    iterations           | 24         |
|    time_elapsed         | 596        |
|    total_timesteps      | 393216     |
| train/                  |            |
|    approx_kl            | 0.04317749 |
|    clip_fraction        | 0.368      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.29      |
|    explained_variance   | 0.865      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.101     |
|    n_updates            | 230        |
|    policy_gradient_loss | -0.0622    |
|    value_loss           | 0.112      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.3       |
|    ep_rew_mean          | 123        |
| time/                   |            |
|    fps                  | 657        |
|    iterations           | 25         |
|    time_elapsed         | 622        |
|    total_timesteps      | 409600     |
| train/                  |            |
|    approx_kl            | 0.04291914 |
|    clip_fraction        | 0.364      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.28      |
|    explained_variance   | 0.866      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0404    |
|    n_updates            | 240        |
|    policy_gradient_loss | -0.0598    |
|    value_loss           | 0.116      |
----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 2 por 400000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30.6     |
|    ep_rew_mean     | 126      |
| time/              |          |
|    fps             | 1920     |
|    iterations      | 1        |
|    time_elapsed    | 17       |
|    total_timesteps | 32768    |
---------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.5       |
|    ep_rew_mean          | 125        |
| time/                   |            |
|    fps                  | 959        |
|    iterations           | 2          |
|    time_elapsed         | 68         |
|    total_timesteps      | 65536      |
| train/                  |            |
|    approx_kl            | 0.04461819 |
|    clip_fraction        | 0.365      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.24      |
|    explained_variance   | 0.87       |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0313    |
|    n_updates            | 10         |
|    policy_gradient_loss | -0.0471    |
|    value_loss           | 0.107      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.8       |
|    ep_rew_mean          | 127        |
| time/                   |            |
|    fps                  | 824        |
|    iterations           | 3          |
|    time_elapsed         | 119        |
|    total_timesteps      | 98304      |
| train/                  |            |
|    approx_kl            | 0.04375048 |
|    clip_fraction        | 0.364      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.2       |
|    explained_variance   | 0.873      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0384    |
|    n_updates            | 20         |
|    policy_gradient_loss | -0.0464    |
|    value_loss           | 0.104      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.7        |
|    ep_rew_mean          | 130         |
| time/                   |             |
|    fps                  | 772         |
|    iterations           | 4           |
|    time_elapsed         | 169         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.045482375 |
|    clip_fraction        | 0.366       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.19       |
|    explained_variance   | 0.879       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0663     |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0472     |
|    value_loss           | 0.103       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.3       |
|    ep_rew_mean          | 127        |
| time/                   |            |
|    fps                  | 743        |
|    iterations           | 5          |
|    time_elapsed         | 220        |
|    total_timesteps      | 163840     |
| train/                  |            |
|    approx_kl            | 0.04519915 |
|    clip_fraction        | 0.366      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.16      |
|    explained_variance   | 0.882      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0588    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0459    |
|    value_loss           | 0.101      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 131         |
| time/                   |             |
|    fps                  | 716         |
|    iterations           | 6           |
|    time_elapsed         | 274         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.047571823 |
|    clip_fraction        | 0.371       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.14       |
|    explained_variance   | 0.879       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0118     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.048      |
|    value_loss           | 0.0995      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 129         |
| time/                   |             |
|    fps                  | 701         |
|    iterations           | 7           |
|    time_elapsed         | 326         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.048506245 |
|    clip_fraction        | 0.374       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.11       |
|    explained_variance   | 0.877       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0484     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0494     |
|    value_loss           | 0.0972      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 133         |
| time/                   |             |
|    fps                  | 688         |
|    iterations           | 8           |
|    time_elapsed         | 380         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.047851026 |
|    clip_fraction        | 0.372       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.09       |
|    explained_variance   | 0.881       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0374     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0486     |
|    value_loss           | 0.0954      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.3       |
|    ep_rew_mean          | 135        |
| time/                   |            |
|    fps                  | 681        |
|    iterations           | 9          |
|    time_elapsed         | 433        |
|    total_timesteps      | 294912     |
| train/                  |            |
|    approx_kl            | 0.05012653 |
|    clip_fraction        | 0.379      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.06      |
|    explained_variance   | 0.883      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0554    |
|    n_updates            | 80         |
|    policy_gradient_loss | -0.0501    |
|    value_loss           | 0.0952     |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 133         |
| time/                   |             |
|    fps                  | 676         |
|    iterations           | 10          |
|    time_elapsed         | 484         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.049834736 |
|    clip_fraction        | 0.374       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.03       |
|    explained_variance   | 0.882       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0381     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0498     |
|    value_loss           | 0.0995      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 672         |
|    iterations           | 11          |
|    time_elapsed         | 536         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.051070705 |
|    clip_fraction        | 0.377       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.02       |
|    explained_variance   | 0.89        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.054      |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0496     |
|    value_loss           | 0.0933      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 668         |
|    iterations           | 12          |
|    time_elapsed         | 587         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.051860467 |
|    clip_fraction        | 0.377       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.99       |
|    explained_variance   | 0.886       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0205     |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0495     |
|    value_loss           | 0.0958      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.9       |
|    ep_rew_mean          | 136        |
| time/                   |            |
|    fps                  | 667        |
|    iterations           | 13         |
|    time_elapsed         | 638        |
|    total_timesteps      | 425984     |
| train/                  |            |
|    approx_kl            | 0.05200892 |
|    clip_fraction        | 0.379      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.98      |
|    explained_variance   | 0.893      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0766    |
|    n_updates            | 120        |
|    policy_gradient_loss | -0.05      |
|    value_loss           | 0.0877     |
----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 3 por 300000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 31.1     |
|    ep_rew_mean     | 138      |
| time/              |          |
|    fps             | 1925     |
|    iterations      | 1        |
|    time_elapsed    | 25       |
|    total_timesteps | 49152    |
---------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30.8      |
|    ep_rew_mean          | 138       |
| time/                   |           |
|    fps                  | 966       |
|    iterations           | 2         |
|    time_elapsed         | 101       |
|    total_timesteps      | 98304     |
| train/                  |           |
|    approx_kl            | 0.0548882 |
|    clip_fraction        | 0.386     |
|    clip_range           | 0.2       |
|    entropy_loss         | -1.92     |
|    explained_variance   | 0.896     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0389   |
|    n_updates            | 10        |
|    policy_gradient_loss | -0.0422   |
|    value_loss           | 0.089     |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 141         |
| time/                   |             |
|    fps                  | 824         |
|    iterations           | 3           |
|    time_elapsed         | 178         |
|    total_timesteps      | 147456      |
| train/                  |             |
|    approx_kl            | 0.054836243 |
|    clip_fraction        | 0.384       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.89       |
|    explained_variance   | 0.898       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0299     |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0418     |
|    value_loss           | 0.0841      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.5       |
|    ep_rew_mean          | 141        |
| time/                   |            |
|    fps                  | 757        |
|    iterations           | 4          |
|    time_elapsed         | 259        |
|    total_timesteps      | 196608     |
| train/                  |            |
|    approx_kl            | 0.05369435 |
|    clip_fraction        | 0.382      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.87      |
|    explained_variance   | 0.901      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0353    |
|    n_updates            | 30         |
|    policy_gradient_loss | -0.0423    |
|    value_loss           | 0.0849     |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.4       |
|    ep_rew_mean          | 143        |
| time/                   |            |
|    fps                  | 730        |
|    iterations           | 5          |
|    time_elapsed         | 336        |
|    total_timesteps      | 245760     |
| train/                  |            |
|    approx_kl            | 0.05547807 |
|    clip_fraction        | 0.382      |
|    clip_range           | 0.2        |
|    entropy_loss         | -1.84      |
|    explained_variance   | 0.893      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0505    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0418    |
|    value_loss           | 0.088      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 145         |
| time/                   |             |
|    fps                  | 712         |
|    iterations           | 6           |
|    time_elapsed         | 413         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.057116996 |
|    clip_fraction        | 0.385       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.82       |
|    explained_variance   | 0.9         |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0391     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0427     |
|    value_loss           | 0.0849      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 140         |
| time/                   |             |
|    fps                  | 699         |
|    iterations           | 7           |
|    time_elapsed         | 491         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.057997454 |
|    clip_fraction        | 0.385       |
|    clip_range           | 0.2         |
|    entropy_loss         | -1.8        |
|    explained_variance   | 0.898       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0461     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.042      |
|    value_loss           | 0.0864      |
-----------------------------------------
INFO:train_maskablePPO_vecnorm:Modelo guardado en best/mppo_ablation/mppo_baseline/seed_126/best/mppo_yahtzee_vecnorm_final y estadisticas de normalizacion en best/mppo_ablation/mppo_baseline/seed_126/best/mppo_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/mppo_ablation/mppo_baseline/seed_126/best/mppo_yahtzee_vecnorm_final, stats=best/mppo_ablation/mppo_baseline/seed_126/best/mppo_vecnorm_stats.pkl, algo=mppo
INFO:final_evaluate_rl:Cargando modelo: best/mppo_ablation/mppo_baseline/seed_126/best/mppo_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: mppo
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 128.34949976950884, Puntuacion final: 130.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 146.17499897629023, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 167.46799919876503, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 157.67399985541124, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 88.92950032837689, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 104.81700074672699, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 146.7529998854734, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 91.29400016146246, Puntuacion final: 93.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 140.4654990013223, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 114.97949986811727, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 148.95650101453066, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 153.07899935147725, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 126.20350042358041, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 145.55599955748767, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 97.71700003521983, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 131.59249903727323, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 112.87650181830395, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 138.42200144054368, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 116.99400049180258, Puntuacion final: 119.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 112.99750051693991, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 146.85949905682355, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 157.38999953179155, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 143.87299830117263, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 158.00950108189136, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 146.3789993065875, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 141.6724992543459, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 151.50500145053957, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 143.87799748312682, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 91.91100042825565, Puntuacion final: 94.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 147.3579998545465, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 136.14950011321343, Puntuacion final: 138.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 132.9509997786954, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 146.13649915903807, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 161.34599821368465, Puntuacion final: 163.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 106.66650123940781, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 145.97750078886747, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 136.1689997361973, Puntuacion final: 138.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 119.18550049688201, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 177.8640021935571, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 170.14999924541917, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 144.82550083147362, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 106.760499709344, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 178.67249701637775, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 149.96600039722398, Puntuacion final: 152.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 172.83150104107335, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 180.7435011623893, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 117.88049917947501, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 142.56150239077397, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 111.89750130020548, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 148.5474989344948, Puntuacion final: 150.0
INFO:final_evaluate_rl:Metricas guardadas en mppo_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/mppo_ablation/mppo_baseline/seed_126/best/mppo_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 137.7483
  Puntuacion final promedio:        139.7200
