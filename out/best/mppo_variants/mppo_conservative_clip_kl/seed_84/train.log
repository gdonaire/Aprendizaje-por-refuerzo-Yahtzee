INFO:train_maskablePPO_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_maskablePPO_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_maskablePPO_vecnorm:Usando arquitectura de politica: {'net_arch': {'pi': [256, 256], 'vf': [256, 256]}}
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 84
  lr: 0.0003
  n_steps: 2048
  batch_size: 64
  n_epochs: 8
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.02
  clip_range: 0.1
  vf_coef: 0.5
  max_grad_norm: 0.5
  policy_arch: {"pi":[256, 256], "vf":[256, 256]}
  eval_episodes: 50
  best_dir: best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best
  plot_ma_long: 200
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 32.6     |
|    ep_rew_mean     | 46.2     |
| time/              |          |
|    fps             | 1796     |
|    iterations      | 1        |
|    time_elapsed    | 9        |
|    total_timesteps | 16384    |
---------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.6         |
|    ep_rew_mean          | 47.3         |
| time/                   |              |
|    fps                  | 1025         |
|    iterations           | 2            |
|    time_elapsed         | 31           |
|    total_timesteps      | 32768        |
| train/                  |              |
|    approx_kl            | 0.0058328393 |
|    clip_fraction        | 0.282        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.07        |
|    explained_variance   | -0.534       |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0289       |
|    n_updates            | 8            |
|    policy_gradient_loss | -0.00923     |
|    value_loss           | 0.259        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.6         |
|    ep_rew_mean          | 50.4         |
| time/                   |              |
|    fps                  | 905          |
|    iterations           | 3            |
|    time_elapsed         | 54           |
|    total_timesteps      | 49152        |
| train/                  |              |
|    approx_kl            | 0.0054560867 |
|    clip_fraction        | 0.285        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.06        |
|    explained_variance   | 0.394        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0384       |
|    n_updates            | 16           |
|    policy_gradient_loss | -0.00935     |
|    value_loss           | 0.221        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.2         |
|    ep_rew_mean          | 50           |
| time/                   |              |
|    fps                  | 825          |
|    iterations           | 4            |
|    time_elapsed         | 79           |
|    total_timesteps      | 65536        |
| train/                  |              |
|    approx_kl            | 0.0054068128 |
|    clip_fraction        | 0.292        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.06        |
|    explained_variance   | 0.63         |
|    learning_rate        | 0.0003       |
|    loss                 | 0.138        |
|    n_updates            | 24           |
|    policy_gradient_loss | -0.00981     |
|    value_loss           | 0.248        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.4         |
|    ep_rew_mean          | 50.1         |
| time/                   |              |
|    fps                  | 803          |
|    iterations           | 5            |
|    time_elapsed         | 101          |
|    total_timesteps      | 81920        |
| train/                  |              |
|    approx_kl            | 0.0056703705 |
|    clip_fraction        | 0.313        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.05        |
|    explained_variance   | 0.674        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0377       |
|    n_updates            | 32           |
|    policy_gradient_loss | -0.0124      |
|    value_loss           | 0.231        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.2         |
|    ep_rew_mean          | 54.9         |
| time/                   |              |
|    fps                  | 791          |
|    iterations           | 6            |
|    time_elapsed         | 124          |
|    total_timesteps      | 98304        |
| train/                  |              |
|    approx_kl            | 0.0060278024 |
|    clip_fraction        | 0.326        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.03        |
|    explained_variance   | 0.725        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0146       |
|    n_updates            | 40           |
|    policy_gradient_loss | -0.0131      |
|    value_loss           | 0.198        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 31.5         |
|    ep_rew_mean          | 58.8         |
| time/                   |              |
|    fps                  | 778          |
|    iterations           | 7            |
|    time_elapsed         | 147          |
|    total_timesteps      | 114688       |
| train/                  |              |
|    approx_kl            | 0.0062134275 |
|    clip_fraction        | 0.328        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.02        |
|    explained_variance   | 0.739        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.00548     |
|    n_updates            | 48           |
|    policy_gradient_loss | -0.0136      |
|    value_loss           | 0.197        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 31.9         |
|    ep_rew_mean          | 63.9         |
| time/                   |              |
|    fps                  | 771          |
|    iterations           | 8            |
|    time_elapsed         | 169          |
|    total_timesteps      | 131072       |
| train/                  |              |
|    approx_kl            | 0.0066382485 |
|    clip_fraction        | 0.333        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.01        |
|    explained_variance   | 0.723        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.00313      |
|    n_updates            | 56           |
|    policy_gradient_loss | -0.0151      |
|    value_loss           | 0.219        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.3         |
|    ep_rew_mean          | 66           |
| time/                   |              |
|    fps                  | 765          |
|    iterations           | 9            |
|    time_elapsed         | 192          |
|    total_timesteps      | 147456       |
| train/                  |              |
|    approx_kl            | 0.0071060318 |
|    clip_fraction        | 0.347        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.99        |
|    explained_variance   | 0.742        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0285       |
|    n_updates            | 64           |
|    policy_gradient_loss | -0.0155      |
|    value_loss           | 0.226        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32           |
|    ep_rew_mean          | 67.1         |
| time/                   |              |
|    fps                  | 761          |
|    iterations           | 10           |
|    time_elapsed         | 215          |
|    total_timesteps      | 163840       |
| train/                  |              |
|    approx_kl            | 0.0073416773 |
|    clip_fraction        | 0.354        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.97        |
|    explained_variance   | 0.741        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.079        |
|    n_updates            | 72           |
|    policy_gradient_loss | -0.0157      |
|    value_loss           | 0.222        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32           |
|    ep_rew_mean          | 67.6         |
| time/                   |              |
|    fps                  | 759          |
|    iterations           | 11           |
|    time_elapsed         | 237          |
|    total_timesteps      | 180224       |
| train/                  |              |
|    approx_kl            | 0.0075143883 |
|    clip_fraction        | 0.356        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.95        |
|    explained_variance   | 0.777        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.00186      |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.0152      |
|    value_loss           | 0.186        |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.9        |
|    ep_rew_mean          | 72.3        |
| time/                   |             |
|    fps                  | 757         |
|    iterations           | 12          |
|    time_elapsed         | 259         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.008317342 |
|    clip_fraction        | 0.364       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.93       |
|    explained_variance   | 0.762       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00978     |
|    n_updates            | 88          |
|    policy_gradient_loss | -0.0168     |
|    value_loss           | 0.207       |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32           |
|    ep_rew_mean          | 78.2         |
| time/                   |              |
|    fps                  | 752          |
|    iterations           | 13           |
|    time_elapsed         | 283          |
|    total_timesteps      | 212992       |
| train/                  |              |
|    approx_kl            | 0.0089922575 |
|    clip_fraction        | 0.383        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.91        |
|    explained_variance   | 0.779        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.0267      |
|    n_updates            | 96           |
|    policy_gradient_loss | -0.0178      |
|    value_loss           | 0.204        |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.8        |
|    ep_rew_mean          | 83.1        |
| time/                   |             |
|    fps                  | 747         |
|    iterations           | 14          |
|    time_elapsed         | 306         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.009282056 |
|    clip_fraction        | 0.387       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.88       |
|    explained_variance   | 0.79        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00265    |
|    n_updates            | 104         |
|    policy_gradient_loss | -0.0184     |
|    value_loss           | 0.198       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.8        |
|    ep_rew_mean          | 89          |
| time/                   |             |
|    fps                  | 745         |
|    iterations           | 15          |
|    time_elapsed         | 329         |
|    total_timesteps      | 245760      |
| train/                  |             |
|    approx_kl            | 0.009898426 |
|    clip_fraction        | 0.399       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.86       |
|    explained_variance   | 0.807       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0552      |
|    n_updates            | 112         |
|    policy_gradient_loss | -0.0184     |
|    value_loss           | 0.186       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.5        |
|    ep_rew_mean          | 85.6        |
| time/                   |             |
|    fps                  | 744         |
|    iterations           | 16          |
|    time_elapsed         | 352         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.009810327 |
|    clip_fraction        | 0.399       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.83       |
|    explained_variance   | 0.82        |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00905     |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0174     |
|    value_loss           | 0.173       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.1        |
|    ep_rew_mean          | 96.3        |
| time/                   |             |
|    fps                  | 743         |
|    iterations           | 17          |
|    time_elapsed         | 374         |
|    total_timesteps      | 278528      |
| train/                  |             |
|    approx_kl            | 0.010515424 |
|    clip_fraction        | 0.407       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.81       |
|    explained_variance   | 0.841       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0235     |
|    n_updates            | 128         |
|    policy_gradient_loss | -0.0176     |
|    value_loss           | 0.153       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 31.4       |
|    ep_rew_mean          | 99.1       |
| time/                   |            |
|    fps                  | 741        |
|    iterations           | 18         |
|    time_elapsed         | 397        |
|    total_timesteps      | 294912     |
| train/                  |            |
|    approx_kl            | 0.01105669 |
|    clip_fraction        | 0.412      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.77      |
|    explained_variance   | 0.855      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.000653   |
|    n_updates            | 136        |
|    policy_gradient_loss | -0.018     |
|    value_loss           | 0.142      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.5        |
|    ep_rew_mean          | 95.7        |
| time/                   |             |
|    fps                  | 740         |
|    iterations           | 19          |
|    time_elapsed         | 420         |
|    total_timesteps      | 311296      |
| train/                  |             |
|    approx_kl            | 0.010843149 |
|    clip_fraction        | 0.409       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.76       |
|    explained_variance   | 0.849       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0565     |
|    n_updates            | 144         |
|    policy_gradient_loss | -0.0167     |
|    value_loss           | 0.147       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.5        |
|    ep_rew_mean          | 103         |
| time/                   |             |
|    fps                  | 739         |
|    iterations           | 20          |
|    time_elapsed         | 442         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.011693399 |
|    clip_fraction        | 0.422       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.73       |
|    explained_variance   | 0.852       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0208     |
|    n_updates            | 152         |
|    policy_gradient_loss | -0.0173     |
|    value_loss           | 0.138       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 105         |
| time/                   |             |
|    fps                  | 738         |
|    iterations           | 21          |
|    time_elapsed         | 465         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.011704305 |
|    clip_fraction        | 0.427       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.72       |
|    explained_variance   | 0.865       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0226     |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.0168     |
|    value_loss           | 0.124       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 107         |
| time/                   |             |
|    fps                  | 738         |
|    iterations           | 22          |
|    time_elapsed         | 488         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.012434823 |
|    clip_fraction        | 0.428       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.68       |
|    explained_variance   | 0.872       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0382     |
|    n_updates            | 168         |
|    policy_gradient_loss | -0.0169     |
|    value_loss           | 0.123       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.2        |
|    ep_rew_mean          | 105         |
| time/                   |             |
|    fps                  | 737         |
|    iterations           | 23          |
|    time_elapsed         | 510         |
|    total_timesteps      | 376832      |
| train/                  |             |
|    approx_kl            | 0.012729297 |
|    clip_fraction        | 0.431       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.66       |
|    explained_variance   | 0.877       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.052      |
|    n_updates            | 176         |
|    policy_gradient_loss | -0.0172     |
|    value_loss           | 0.12        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.3        |
|    ep_rew_mean          | 110         |
| time/                   |             |
|    fps                  | 737         |
|    iterations           | 24          |
|    time_elapsed         | 533         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.013274022 |
|    clip_fraction        | 0.433       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.63       |
|    explained_variance   | 0.875       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0172     |
|    n_updates            | 184         |
|    policy_gradient_loss | -0.0175     |
|    value_loss           | 0.117       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 114         |
| time/                   |             |
|    fps                  | 737         |
|    iterations           | 25          |
|    time_elapsed         | 555         |
|    total_timesteps      | 409600      |
| train/                  |             |
|    approx_kl            | 0.013392506 |
|    clip_fraction        | 0.432       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.62       |
|    explained_variance   | 0.885       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00696    |
|    n_updates            | 192         |
|    policy_gradient_loss | -0.0175     |
|    value_loss           | 0.113       |
-----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 2 por 400000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 31.1     |
|    ep_rew_mean     | 116      |
| time/              |          |
|    fps             | 1882     |
|    iterations      | 1        |
|    time_elapsed    | 17       |
|    total_timesteps | 32768    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.8        |
|    ep_rew_mean          | 116         |
| time/                   |             |
|    fps                  | 991         |
|    iterations           | 2           |
|    time_elapsed         | 66          |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.014330186 |
|    clip_fraction        | 0.444       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.56       |
|    explained_variance   | 0.882       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00405     |
|    n_updates            | 8           |
|    policy_gradient_loss | -0.0112     |
|    value_loss           | 0.119       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 122         |
| time/                   |             |
|    fps                  | 886         |
|    iterations           | 3           |
|    time_elapsed         | 110         |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.014203847 |
|    clip_fraction        | 0.439       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.53       |
|    explained_variance   | 0.884       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.000913    |
|    n_updates            | 16          |
|    policy_gradient_loss | -0.0104     |
|    value_loss           | 0.118       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 121         |
| time/                   |             |
|    fps                  | 841         |
|    iterations           | 4           |
|    time_elapsed         | 155         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.014726802 |
|    clip_fraction        | 0.441       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.5        |
|    explained_variance   | 0.884       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00745    |
|    n_updates            | 24          |
|    policy_gradient_loss | -0.011      |
|    value_loss           | 0.117       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 124         |
| time/                   |             |
|    fps                  | 816         |
|    iterations           | 5           |
|    time_elapsed         | 200         |
|    total_timesteps      | 163840      |
| train/                  |             |
|    approx_kl            | 0.015633296 |
|    clip_fraction        | 0.441       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.48       |
|    explained_variance   | 0.883       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00932    |
|    n_updates            | 32          |
|    policy_gradient_loss | -0.0116     |
|    value_loss           | 0.117       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 127         |
| time/                   |             |
|    fps                  | 802         |
|    iterations           | 6           |
|    time_elapsed         | 245         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.015795263 |
|    clip_fraction        | 0.437       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.45       |
|    explained_variance   | 0.889       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00503     |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0111     |
|    value_loss           | 0.11        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 129         |
| time/                   |             |
|    fps                  | 791         |
|    iterations           | 7           |
|    time_elapsed         | 289         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.015364402 |
|    clip_fraction        | 0.437       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.44       |
|    explained_variance   | 0.894       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00136     |
|    n_updates            | 48          |
|    policy_gradient_loss | -0.0117     |
|    value_loss           | 0.103       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 129         |
| time/                   |             |
|    fps                  | 781         |
|    iterations           | 8           |
|    time_elapsed         | 335         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.015793702 |
|    clip_fraction        | 0.439       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.41       |
|    explained_variance   | 0.897       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00823    |
|    n_updates            | 56          |
|    policy_gradient_loss | -0.0121     |
|    value_loss           | 0.0991      |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30.4      |
|    ep_rew_mean          | 133       |
| time/                   |           |
|    fps                  | 774       |
|    iterations           | 9         |
|    time_elapsed         | 380       |
|    total_timesteps      | 294912    |
| train/                  |           |
|    approx_kl            | 0.0160332 |
|    clip_fraction        | 0.435     |
|    clip_range           | 0.1       |
|    entropy_loss         | -2.39     |
|    explained_variance   | 0.894     |
|    learning_rate        | 0.0003    |
|    loss                 | 0.0333    |
|    n_updates            | 64        |
|    policy_gradient_loss | -0.0119   |
|    value_loss           | 0.101     |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.3        |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 769         |
|    iterations           | 10          |
|    time_elapsed         | 425         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.016784422 |
|    clip_fraction        | 0.443       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.37       |
|    explained_variance   | 0.904       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00441     |
|    n_updates            | 72          |
|    policy_gradient_loss | -0.013      |
|    value_loss           | 0.0914      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31          |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 765         |
|    iterations           | 11          |
|    time_elapsed         | 470         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.017510027 |
|    clip_fraction        | 0.448       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.36       |
|    explained_variance   | 0.905       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00512    |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0126     |
|    value_loss           | 0.0893      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.2        |
|    ep_rew_mean          | 133         |
| time/                   |             |
|    fps                  | 762         |
|    iterations           | 12          |
|    time_elapsed         | 515         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.017451795 |
|    clip_fraction        | 0.446       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.34       |
|    explained_variance   | 0.904       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00313    |
|    n_updates            | 88          |
|    policy_gradient_loss | -0.0128     |
|    value_loss           | 0.0884      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.8        |
|    ep_rew_mean          | 137         |
| time/                   |             |
|    fps                  | 759         |
|    iterations           | 13          |
|    time_elapsed         | 560         |
|    total_timesteps      | 425984      |
| train/                  |             |
|    approx_kl            | 0.018001996 |
|    clip_fraction        | 0.45        |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.34       |
|    explained_variance   | 0.902       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0161     |
|    n_updates            | 96          |
|    policy_gradient_loss | -0.0134     |
|    value_loss           | 0.0894      |
-----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 3 por 300000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30.7     |
|    ep_rew_mean     | 134      |
| time/              |          |
|    fps             | 1864     |
|    iterations      | 1        |
|    time_elapsed    | 26       |
|    total_timesteps | 49152    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 138         |
| time/                   |             |
|    fps                  | 999         |
|    iterations           | 2           |
|    time_elapsed         | 98          |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.019224336 |
|    clip_fraction        | 0.456       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.3        |
|    explained_variance   | 0.902       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00513    |
|    n_updates            | 8           |
|    policy_gradient_loss | -0.00876    |
|    value_loss           | 0.0901      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 136         |
| time/                   |             |
|    fps                  | 888         |
|    iterations           | 3           |
|    time_elapsed         | 166         |
|    total_timesteps      | 147456      |
| train/                  |             |
|    approx_kl            | 0.019399555 |
|    clip_fraction        | 0.459       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.28       |
|    explained_variance   | 0.905       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0133      |
|    n_updates            | 16          |
|    policy_gradient_loss | -0.0094     |
|    value_loss           | 0.0882      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.2        |
|    ep_rew_mean          | 136         |
| time/                   |             |
|    fps                  | 844         |
|    iterations           | 4           |
|    time_elapsed         | 232         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.019605218 |
|    clip_fraction        | 0.455       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.27       |
|    explained_variance   | 0.907       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0116      |
|    n_updates            | 24          |
|    policy_gradient_loss | -0.00913    |
|    value_loss           | 0.0853      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 143         |
| time/                   |             |
|    fps                  | 820         |
|    iterations           | 5           |
|    time_elapsed         | 299         |
|    total_timesteps      | 245760      |
| train/                  |             |
|    approx_kl            | 0.020071844 |
|    clip_fraction        | 0.459       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.25       |
|    explained_variance   | 0.905       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0111      |
|    n_updates            | 32          |
|    policy_gradient_loss | -0.00948    |
|    value_loss           | 0.0885      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 141         |
| time/                   |             |
|    fps                  | 803         |
|    iterations           | 6           |
|    time_elapsed         | 367         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.020996606 |
|    clip_fraction        | 0.464       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.22       |
|    explained_variance   | 0.906       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0332      |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.00984    |
|    value_loss           | 0.0862      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 31.1       |
|    ep_rew_mean          | 137        |
| time/                   |            |
|    fps                  | 790        |
|    iterations           | 7          |
|    time_elapsed         | 435        |
|    total_timesteps      | 344064     |
| train/                  |            |
|    approx_kl            | 0.02111125 |
|    clip_fraction        | 0.462      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.2       |
|    explained_variance   | 0.902      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.00925    |
|    n_updates            | 48         |
|    policy_gradient_loss | -0.0103    |
|    value_loss           | 0.088      |
----------------------------------------
INFO:train_maskablePPO_vecnorm:Modelo guardado en best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_yahtzee_vecnorm_final y estadisticas de normalizacion en best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_yahtzee_vecnorm_final, stats=best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_vecnorm_stats.pkl, algo=mppo
INFO:final_evaluate_rl:Cargando modelo: best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: mppo
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 166.78450077027082, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 158.36149937962182, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 146.7689986010082, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 142.49249798222445, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 122.27000103989849, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 149.91050055623055, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 141.76100060064346, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 112.01699902961263, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 146.9069988099509, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 139.62449747917708, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 106.70200067537371, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 133.0865005464293, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 173.28500085067935, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 118.36949908651877, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 155.4785001213313, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 90.41799906094093, Puntuacion final: 93.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 153.1814995603636, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 122.39950107882032, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 182.8810022661928, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 148.3275016308762, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 139.5345003278926, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 126.87200100440532, Puntuacion final: 130.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 104.58350058936048, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 110.07899879215984, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 123.41299875779077, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 157.07000017596874, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 140.95200098631904, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 142.1809996276861, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 153.8459969679825, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 108.37700073001906, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 157.58899940247647, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 136.60799980082083, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 105.39299971773289, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 103.67250031232834, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 113.30549909058027, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 108.8955011293292, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 102.49549913185183, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 155.175501128193, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 113.71900059678592, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 143.1804996416904, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 147.27299803076312, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 166.92649951577187, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 95.17499893670902, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 97.9234990151599, Puntuacion final: 101.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 95.08800095925108, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 110.88149889046326, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 163.83550003456185, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 89.92500096280128, Puntuacion final: 93.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 151.24000090092886, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 103.89099872182123, Puntuacion final: 106.0
INFO:final_evaluate_rl:Metricas guardadas en mppo_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/mppo_ablation/mppo_conservative_clip_kl/seed_84/best/mppo_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 131.6025
  Puntuacion final promedio:        133.7800
