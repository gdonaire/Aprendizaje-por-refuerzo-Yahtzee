INFO:train_maskablePPO_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_maskablePPO_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_maskablePPO_vecnorm:Usando arquitectura de politica: {'net_arch': {'pi': [256, 256], 'vf': [256, 256]}}
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0003
  n_steps: 2048
  batch_size: 64
  n_epochs: 8
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.02
  clip_range: 0.1
  vf_coef: 0.5
  max_grad_norm: 0.5
  policy_arch: {"pi":[256, 256], "vf":[256, 256]}
  eval_episodes: 50
  best_dir: best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best
  plot_ma_long: 200
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 32.4     |
|    ep_rew_mean     | 44.3     |
| time/              |          |
|    fps             | 1944     |
|    iterations      | 1        |
|    time_elapsed    | 8        |
|    total_timesteps | 16384    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 32.1        |
|    ep_rew_mean          | 43.7        |
| time/                   |             |
|    fps                  | 1067        |
|    iterations           | 2           |
|    time_elapsed         | 30          |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.005344634 |
|    clip_fraction        | 0.29        |
|    clip_range           | 0.1         |
|    entropy_loss         | -3.07       |
|    explained_variance   | 0.00871     |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00772    |
|    n_updates            | 8           |
|    policy_gradient_loss | -0.0102     |
|    value_loss           | 0.276       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 32.4       |
|    ep_rew_mean          | 44         |
| time/                   |            |
|    fps                  | 937        |
|    iterations           | 3          |
|    time_elapsed         | 52         |
|    total_timesteps      | 49152      |
| train/                  |            |
|    approx_kl            | 0.00523017 |
|    clip_fraction        | 0.289      |
|    clip_range           | 0.1        |
|    entropy_loss         | -3.06      |
|    explained_variance   | 0.471      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.0256     |
|    n_updates            | 16         |
|    policy_gradient_loss | -0.0104    |
|    value_loss           | 0.259      |
----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.2         |
|    ep_rew_mean          | 48.5         |
| time/                   |              |
|    fps                  | 880          |
|    iterations           | 4            |
|    time_elapsed         | 74           |
|    total_timesteps      | 65536        |
| train/                  |              |
|    approx_kl            | 0.0059226584 |
|    clip_fraction        | 0.314        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.05        |
|    explained_variance   | 0.659        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0142       |
|    n_updates            | 24           |
|    policy_gradient_loss | -0.0118      |
|    value_loss           | 0.202        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 31.8         |
|    ep_rew_mean          | 49.7         |
| time/                   |              |
|    fps                  | 850          |
|    iterations           | 5            |
|    time_elapsed         | 96           |
|    total_timesteps      | 81920        |
| train/                  |              |
|    approx_kl            | 0.0059755286 |
|    clip_fraction        | 0.32         |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.04        |
|    explained_variance   | 0.691        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.00179      |
|    n_updates            | 32           |
|    policy_gradient_loss | -0.0125      |
|    value_loss           | 0.222        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32           |
|    ep_rew_mean          | 53           |
| time/                   |              |
|    fps                  | 832          |
|    iterations           | 6            |
|    time_elapsed         | 118          |
|    total_timesteps      | 98304        |
| train/                  |              |
|    approx_kl            | 0.0059841257 |
|    clip_fraction        | 0.32         |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.03        |
|    explained_variance   | 0.697        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0293       |
|    n_updates            | 40           |
|    policy_gradient_loss | -0.0133      |
|    value_loss           | 0.228        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 32.3         |
|    ep_rew_mean          | 60.1         |
| time/                   |              |
|    fps                  | 818          |
|    iterations           | 7            |
|    time_elapsed         | 140          |
|    total_timesteps      | 114688       |
| train/                  |              |
|    approx_kl            | 0.0061953114 |
|    clip_fraction        | 0.331        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3.01        |
|    explained_variance   | 0.722        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0183       |
|    n_updates            | 48           |
|    policy_gradient_loss | -0.014       |
|    value_loss           | 0.223        |
------------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 31.8         |
|    ep_rew_mean          | 60.3         |
| time/                   |              |
|    fps                  | 792          |
|    iterations           | 8            |
|    time_elapsed         | 165          |
|    total_timesteps      | 131072       |
| train/                  |              |
|    approx_kl            | 0.0068840524 |
|    clip_fraction        | 0.345        |
|    clip_range           | 0.1          |
|    entropy_loss         | -3           |
|    explained_variance   | 0.734        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.0356       |
|    n_updates            | 56           |
|    policy_gradient_loss | -0.0153      |
|    value_loss           | 0.217        |
------------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 32.3       |
|    ep_rew_mean          | 65.1       |
| time/                   |            |
|    fps                  | 782        |
|    iterations           | 9          |
|    time_elapsed         | 188        |
|    total_timesteps      | 147456     |
| train/                  |            |
|    approx_kl            | 0.00727511 |
|    clip_fraction        | 0.352      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.98      |
|    explained_variance   | 0.746      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.00703    |
|    n_updates            | 64         |
|    policy_gradient_loss | -0.0154    |
|    value_loss           | 0.214      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.7        |
|    ep_rew_mean          | 70.4        |
| time/                   |             |
|    fps                  | 776         |
|    iterations           | 10          |
|    time_elapsed         | 211         |
|    total_timesteps      | 163840      |
| train/                  |             |
|    approx_kl            | 0.007632128 |
|    clip_fraction        | 0.358       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.96       |
|    explained_variance   | 0.742       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0379      |
|    n_updates            | 72          |
|    policy_gradient_loss | -0.0159     |
|    value_loss           | 0.227       |
-----------------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 31.7         |
|    ep_rew_mean          | 69.5         |
| time/                   |              |
|    fps                  | 773          |
|    iterations           | 11           |
|    time_elapsed         | 233          |
|    total_timesteps      | 180224       |
| train/                  |              |
|    approx_kl            | 0.0081153065 |
|    clip_fraction        | 0.369        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.94        |
|    explained_variance   | 0.762        |
|    learning_rate        | 0.0003       |
|    loss                 | -0.009       |
|    n_updates            | 80           |
|    policy_gradient_loss | -0.0167      |
|    value_loss           | 0.207        |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.2        |
|    ep_rew_mean          | 77          |
| time/                   |             |
|    fps                  | 769         |
|    iterations           | 12          |
|    time_elapsed         | 255         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.007905802 |
|    clip_fraction        | 0.369       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.92       |
|    explained_variance   | 0.786       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0118     |
|    n_updates            | 88          |
|    policy_gradient_loss | -0.0162     |
|    value_loss           | 0.203       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.7        |
|    ep_rew_mean          | 79.6        |
| time/                   |             |
|    fps                  | 766         |
|    iterations           | 13          |
|    time_elapsed         | 277         |
|    total_timesteps      | 212992      |
| train/                  |             |
|    approx_kl            | 0.009201613 |
|    clip_fraction        | 0.387       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.9        |
|    explained_variance   | 0.792       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0272     |
|    n_updates            | 96          |
|    policy_gradient_loss | -0.0172     |
|    value_loss           | 0.186       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.5        |
|    ep_rew_mean          | 81.2        |
| time/                   |             |
|    fps                  | 763         |
|    iterations           | 14          |
|    time_elapsed         | 300         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.009244405 |
|    clip_fraction        | 0.39        |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.88       |
|    explained_variance   | 0.788       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0177     |
|    n_updates            | 104         |
|    policy_gradient_loss | -0.0172     |
|    value_loss           | 0.193       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 86.4        |
| time/                   |             |
|    fps                  | 761         |
|    iterations           | 15          |
|    time_elapsed         | 322         |
|    total_timesteps      | 245760      |
| train/                  |             |
|    approx_kl            | 0.009582053 |
|    clip_fraction        | 0.394       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.85       |
|    explained_variance   | 0.788       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0375      |
|    n_updates            | 112         |
|    policy_gradient_loss | -0.0173     |
|    value_loss           | 0.192       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.3        |
|    ep_rew_mean          | 90.7        |
| time/                   |             |
|    fps                  | 760         |
|    iterations           | 16          |
|    time_elapsed         | 344         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.009869812 |
|    clip_fraction        | 0.397       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.83       |
|    explained_variance   | 0.818       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0367     |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.017      |
|    value_loss           | 0.163       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.2        |
|    ep_rew_mean          | 90.8        |
| time/                   |             |
|    fps                  | 758         |
|    iterations           | 17          |
|    time_elapsed         | 367         |
|    total_timesteps      | 278528      |
| train/                  |             |
|    approx_kl            | 0.010261331 |
|    clip_fraction        | 0.403       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.8        |
|    explained_variance   | 0.84        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0271     |
|    n_updates            | 128         |
|    policy_gradient_loss | -0.0174     |
|    value_loss           | 0.15        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 96.2        |
| time/                   |             |
|    fps                  | 757         |
|    iterations           | 18          |
|    time_elapsed         | 389         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.011209808 |
|    clip_fraction        | 0.413       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.78       |
|    explained_variance   | 0.837       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0101     |
|    n_updates            | 136         |
|    policy_gradient_loss | -0.0183     |
|    value_loss           | 0.144       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.1        |
|    ep_rew_mean          | 99.3        |
| time/                   |             |
|    fps                  | 756         |
|    iterations           | 19          |
|    time_elapsed         | 411         |
|    total_timesteps      | 311296      |
| train/                  |             |
|    approx_kl            | 0.011852866 |
|    clip_fraction        | 0.422       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.76       |
|    explained_variance   | 0.848       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0238     |
|    n_updates            | 144         |
|    policy_gradient_loss | -0.0185     |
|    value_loss           | 0.138       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 31.1        |
|    ep_rew_mean          | 98.6        |
| time/                   |             |
|    fps                  | 754         |
|    iterations           | 20          |
|    time_elapsed         | 434         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.012315166 |
|    clip_fraction        | 0.429       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.73       |
|    explained_variance   | 0.851       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0196     |
|    n_updates            | 152         |
|    policy_gradient_loss | -0.0186     |
|    value_loss           | 0.143       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 107         |
| time/                   |             |
|    fps                  | 752         |
|    iterations           | 21          |
|    time_elapsed         | 457         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.011888136 |
|    clip_fraction        | 0.418       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.71       |
|    explained_variance   | 0.856       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0274      |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.0179     |
|    value_loss           | 0.13        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 106         |
| time/                   |             |
|    fps                  | 751         |
|    iterations           | 22          |
|    time_elapsed         | 479         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.012411648 |
|    clip_fraction        | 0.426       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.69       |
|    explained_variance   | 0.864       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00723    |
|    n_updates            | 168         |
|    policy_gradient_loss | -0.0176     |
|    value_loss           | 0.132       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.7        |
|    ep_rew_mean          | 110         |
| time/                   |             |
|    fps                  | 750         |
|    iterations           | 23          |
|    time_elapsed         | 502         |
|    total_timesteps      | 376832      |
| train/                  |             |
|    approx_kl            | 0.012658564 |
|    clip_fraction        | 0.429       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.66       |
|    explained_variance   | 0.864       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0275     |
|    n_updates            | 176         |
|    policy_gradient_loss | -0.0186     |
|    value_loss           | 0.123       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.6        |
|    ep_rew_mean          | 114         |
| time/                   |             |
|    fps                  | 749         |
|    iterations           | 24          |
|    time_elapsed         | 524         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.013259825 |
|    clip_fraction        | 0.438       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.64       |
|    explained_variance   | 0.876       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0397     |
|    n_updates            | 184         |
|    policy_gradient_loss | -0.0178     |
|    value_loss           | 0.109       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.7       |
|    ep_rew_mean          | 113        |
| time/                   |            |
|    fps                  | 748        |
|    iterations           | 25         |
|    time_elapsed         | 547        |
|    total_timesteps      | 409600     |
| train/                  |            |
|    approx_kl            | 0.01354447 |
|    clip_fraction        | 0.435      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.62      |
|    explained_variance   | 0.876      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.00855   |
|    n_updates            | 192        |
|    policy_gradient_loss | -0.0181    |
|    value_loss           | 0.113      |
----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 2 por 400000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30.3     |
|    ep_rew_mean     | 117      |
| time/              |          |
|    fps             | 1856     |
|    iterations      | 1        |
|    time_elapsed    | 17       |
|    total_timesteps | 32768    |
---------------------------------
------------------------------------------
| rollout/                |              |
|    ep_len_mean          | 29.9         |
|    ep_rew_mean          | 118          |
| time/                   |              |
|    fps                  | 1042         |
|    iterations           | 2            |
|    time_elapsed         | 62           |
|    total_timesteps      | 65536        |
| train/                  |              |
|    approx_kl            | 0.0134312995 |
|    clip_fraction        | 0.437        |
|    clip_range           | 0.1          |
|    entropy_loss         | -2.57        |
|    explained_variance   | 0.872        |
|    learning_rate        | 0.0003       |
|    loss                 | 0.00255      |
|    n_updates            | 8            |
|    policy_gradient_loss | -0.0107      |
|    value_loss           | 0.128        |
------------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 123         |
| time/                   |             |
|    fps                  | 917         |
|    iterations           | 3           |
|    time_elapsed         | 107         |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.014055254 |
|    clip_fraction        | 0.444       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.54       |
|    explained_variance   | 0.887       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0305      |
|    n_updates            | 16          |
|    policy_gradient_loss | -0.0109     |
|    value_loss           | 0.117       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.1        |
|    ep_rew_mean          | 126         |
| time/                   |             |
|    fps                  | 865         |
|    iterations           | 4           |
|    time_elapsed         | 151         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.013972206 |
|    clip_fraction        | 0.437       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.53       |
|    explained_variance   | 0.887       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0104     |
|    n_updates            | 24          |
|    policy_gradient_loss | -0.0106     |
|    value_loss           | 0.112       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.7        |
|    ep_rew_mean          | 119         |
| time/                   |             |
|    fps                  | 824         |
|    iterations           | 5           |
|    time_elapsed         | 198         |
|    total_timesteps      | 163840      |
| train/                  |             |
|    approx_kl            | 0.015283919 |
|    clip_fraction        | 0.438       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.49       |
|    explained_variance   | 0.891       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.000897   |
|    n_updates            | 32          |
|    policy_gradient_loss | -0.0118     |
|    value_loss           | 0.107       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.1       |
|    ep_rew_mean          | 128        |
| time/                   |            |
|    fps                  | 804        |
|    iterations           | 6          |
|    time_elapsed         | 244        |
|    total_timesteps      | 196608     |
| train/                  |            |
|    approx_kl            | 0.01576783 |
|    clip_fraction        | 0.442      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.46      |
|    explained_variance   | 0.893      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.00342    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0123    |
|    value_loss           | 0.103      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.8        |
|    ep_rew_mean          | 130         |
| time/                   |             |
|    fps                  | 792         |
|    iterations           | 7           |
|    time_elapsed         | 289         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.015479488 |
|    clip_fraction        | 0.44        |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.44       |
|    explained_variance   | 0.894       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.000622    |
|    n_updates            | 48          |
|    policy_gradient_loss | -0.0118     |
|    value_loss           | 0.104       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.2        |
|    ep_rew_mean          | 126         |
| time/                   |             |
|    fps                  | 783         |
|    iterations           | 8           |
|    time_elapsed         | 334         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.015486859 |
|    clip_fraction        | 0.444       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.43       |
|    explained_variance   | 0.894       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00823     |
|    n_updates            | 56          |
|    policy_gradient_loss | -0.0113     |
|    value_loss           | 0.1         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 29.9        |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 778         |
|    iterations           | 9           |
|    time_elapsed         | 378         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.016324427 |
|    clip_fraction        | 0.439       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.42       |
|    explained_variance   | 0.896       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0107      |
|    n_updates            | 64          |
|    policy_gradient_loss | -0.0123     |
|    value_loss           | 0.0956      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.9        |
|    ep_rew_mean          | 132         |
| time/                   |             |
|    fps                  | 773         |
|    iterations           | 10          |
|    time_elapsed         | 423         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.016730953 |
|    clip_fraction        | 0.448       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.4        |
|    explained_variance   | 0.893       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0087      |
|    n_updates            | 72          |
|    policy_gradient_loss | -0.0125     |
|    value_loss           | 0.094       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 133         |
| time/                   |             |
|    fps                  | 769         |
|    iterations           | 11          |
|    time_elapsed         | 468         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.017251402 |
|    clip_fraction        | 0.445       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.37       |
|    explained_variance   | 0.891       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.00554    |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.013      |
|    value_loss           | 0.0957      |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.5        |
|    ep_rew_mean          | 134         |
| time/                   |             |
|    fps                  | 764         |
|    iterations           | 12          |
|    time_elapsed         | 514         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.017437773 |
|    clip_fraction        | 0.442       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.35       |
|    explained_variance   | 0.9         |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0189     |
|    n_updates            | 88          |
|    policy_gradient_loss | -0.0126     |
|    value_loss           | 0.0898      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.7       |
|    ep_rew_mean          | 135        |
| time/                   |            |
|    fps                  | 761        |
|    iterations           | 13         |
|    time_elapsed         | 559        |
|    total_timesteps      | 425984     |
| train/                  |            |
|    approx_kl            | 0.01776052 |
|    clip_fraction        | 0.443      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.33      |
|    explained_variance   | 0.9        |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0127    |
|    n_updates            | 96         |
|    policy_gradient_loss | -0.013     |
|    value_loss           | 0.0889     |
----------------------------------------
INFO:train_maskablePPO_vecnorm:Entrenando MaskablePPO Fase 3 por 300000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 30.9     |
|    ep_rew_mean     | 138      |
| time/              |          |
|    fps             | 1858     |
|    iterations      | 1        |
|    time_elapsed    | 26       |
|    total_timesteps | 49152    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30          |
|    ep_rew_mean          | 136         |
| time/                   |             |
|    fps                  | 1051        |
|    iterations           | 2           |
|    time_elapsed         | 93          |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.017874615 |
|    clip_fraction        | 0.448       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.3        |
|    explained_variance   | 0.906       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00911     |
|    n_updates            | 8           |
|    policy_gradient_loss | -0.00864    |
|    value_loss           | 0.0853      |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30.4       |
|    ep_rew_mean          | 134        |
| time/                   |            |
|    fps                  | 917        |
|    iterations           | 3          |
|    time_elapsed         | 160        |
|    total_timesteps      | 147456     |
| train/                  |            |
|    approx_kl            | 0.01932724 |
|    clip_fraction        | 0.453      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.27      |
|    explained_variance   | 0.904      |
|    learning_rate        | 0.0003     |
|    loss                 | 0.0207     |
|    n_updates            | 16         |
|    policy_gradient_loss | -0.00956   |
|    value_loss           | 0.0864     |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.7        |
|    ep_rew_mean          | 139         |
| time/                   |             |
|    fps                  | 840         |
|    iterations           | 4           |
|    time_elapsed         | 234         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.018687446 |
|    clip_fraction        | 0.452       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.25       |
|    explained_variance   | 0.905       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0226      |
|    n_updates            | 24          |
|    policy_gradient_loss | -0.00956    |
|    value_loss           | 0.086       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 30         |
|    ep_rew_mean          | 139        |
| time/                   |            |
|    fps                  | 810        |
|    iterations           | 5          |
|    time_elapsed         | 303        |
|    total_timesteps      | 245760     |
| train/                  |            |
|    approx_kl            | 0.01977851 |
|    clip_fraction        | 0.457      |
|    clip_range           | 0.1        |
|    entropy_loss         | -2.23      |
|    explained_variance   | 0.91       |
|    learning_rate        | 0.0003     |
|    loss                 | 0.0196     |
|    n_updates            | 32         |
|    policy_gradient_loss | -0.00956   |
|    value_loss           | 0.0818     |
----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 30.8      |
|    ep_rew_mean          | 138       |
| time/                   |           |
|    fps                  | 793       |
|    iterations           | 6         |
|    time_elapsed         | 371       |
|    total_timesteps      | 294912    |
| train/                  |           |
|    approx_kl            | 0.0200354 |
|    clip_fraction        | 0.461     |
|    clip_range           | 0.1       |
|    entropy_loss         | -2.23     |
|    explained_variance   | 0.904     |
|    learning_rate        | 0.0003    |
|    loss                 | -0.00871  |
|    n_updates            | 40        |
|    policy_gradient_loss | -0.00977  |
|    value_loss           | 0.0833    |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 30.4        |
|    ep_rew_mean          | 142         |
| time/                   |             |
|    fps                  | 782         |
|    iterations           | 7           |
|    time_elapsed         | 439         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.020259786 |
|    clip_fraction        | 0.459       |
|    clip_range           | 0.1         |
|    entropy_loss         | -2.21       |
|    explained_variance   | 0.906       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0067      |
|    n_updates            | 48          |
|    policy_gradient_loss | -0.0102     |
|    value_loss           | 0.08        |
-----------------------------------------
INFO:train_maskablePPO_vecnorm:Modelo guardado en best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_yahtzee_vecnorm_final y estadisticas de normalizacion en best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_yahtzee_vecnorm_final, stats=best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_vecnorm_stats.pkl, algo=mppo
INFO:final_evaluate_rl:Cargando modelo: best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: mppo
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 158.36799941258505, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 117.39750217786059, Puntuacion final: 119.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 162.50149972736835, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 100.03750244528055, Puntuacion final: 102.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 118.5064994096756, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 105.7865001084283, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 90.19449991639704, Puntuacion final: 92.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 105.1159983528778, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 76.93799906084314, Puntuacion final: 80.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 147.70800029631937, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 154.7344983649673, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 146.86500054318458, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 145.0880015810253, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 161.88349665421993, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 103.05700034997426, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 111.3754995848285, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 101.49049807223491, Puntuacion final: 103.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 126.54249835759401, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 138.09700098633766, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 116.07599793071859, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 142.25499961455353, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 110.01949951797724, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 106.38849838124588, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 140.0804988592863, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 155.2790009120945, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 133.86950037028873, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 146.23799960827455, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 117.79999888734892, Puntuacion final: 119.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 159.11349868541583, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 103.09350078506395, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 131.47249988117255, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 96.92349773459136, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 140.46149982279167, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 186.03799957502633, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 140.6735019609332, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 145.16599916294217, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 149.6755000129342, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 132.29200097732246, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 153.16449925792404, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 113.90149888722226, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 174.38949889224023, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 121.11350056435913, Puntuacion final: 123.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 153.8869984894991, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 145.90000164043158, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 157.0544993877411, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 106.7050013836124, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 103.42850070592249, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 108.3664998994791, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 155.8610010505654, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 112.48200112115592, Puntuacion final: 114.0
INFO:final_evaluate_rl:Metricas guardadas en mppo_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/mppo_ablation/mppo_conservative_clip_kl/seed_126/best/mppo_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 130.6171
  Puntuacion final promedio:        132.6600
