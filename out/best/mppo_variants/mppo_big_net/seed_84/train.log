INFO:train_mppo_vecnorm:Creando 8 entornos paralelos...
INFO:train_mppo_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_mppo_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_mppo_vecnorm:Usando arquitectura de politica: {'net_arch': {'pi': [256, 256, 256], 'vf': [256, 256, 256]}}
INFO:train_mppo_vecnorm:Entrenando MPPO Fase 1 por 400000 timesteps...
Argumentos de entrenamiento MPPO:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 84
  lr: 0.0001
  n_steps: 3
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.02
  clip_range: 0.2
  vf_coef: 0.5
  max_grad_norm: 1.0
  policy_arch: {"pi":[256, 256,256], "vf":[256, 256,256]}
  eval_episodes: 50
  best_dir: best/mppo_variants/mppo_big_net/seed_84/best
  plot_ma_long: 200
Using cpu device
----------------------------
| time/              |     |
|    fps             | 869 |
|    iterations      | 1   |
|    time_elapsed    | 0   |
|    total_timesteps | 24  |
----------------------------
------------------------------------------
| time/                   |              |
|    fps                  | 253          |
|    iterations           | 2            |
|    time_elapsed         | 0            |
|    total_timesteps      | 48           |
| train/                  |              |
|    approx_kl            | 0.0035363857 |
|    clip_fraction        | 0            |
|    clip_range           | 0.2          |
|    entropy_loss         | -3.52        |
|    explained_variance   | 0.0917       |
|    learning_rate        | 0.0001       |
|    loss                 | 1.05         |
|    n_updates            | 10           |
|    policy_gradient_loss | -0.0346      |
|    value_loss           | 2.95         |
------------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 29.2       |
|    ep_rew_mean          | 135        |
| time/                   |            |
|    fps                  | 286        |
|    iterations           | 4167       |
|    time_elapsed         | 1046       |
|    total_timesteps      | 300024     |
| train/                  |            |
|    approx_kl            | 0.07651976 |
|    clip_fraction        | 0.172      |
|    clip_range           | 0.2        |
|    entropy_loss         | -0.533     |
|    explained_variance   | 0.893      |
|    learning_rate        | 0.0001     |
|    loss                 | -0.0339    |
|    n_updates            | 41660      |
|    policy_gradient_loss | -0.045     |
|    value_loss           | 0.0855     |
----------------------------------------
INFO:train_mppo_vecnorm:Modelo guardado en best/mppo_variants/mppo_big_net/seed_84/best/mppo_yahtzee_vecnorm_model y estadisticas de normalizacion en best/mppo_variants/mppo_big_net/seed_84/best/mppo_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/mppo_variants/mppo_big_net/seed_84/best/mppo_yahtzee_vecnorm_model, stats=best/mppo_variants/mppo_big_net/seed_84/best/mppo_yahtzee_vecnorm_stats.pkl, algo=mppo
INFO:final_evaluate_rl:Cargando modelo: best/mppo_variants/mppo_big_net/seed_84/best/mppo_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: mppo
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 95.79199963691644, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 123.62050111789722, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 156.5585005641915, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 165.98199937591562, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 115.33750094636343, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 127.26849934458733, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 95.88499944668729, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 114.89900130033493, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 129.8545008675428, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 113.63950014906004, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 120.6589984362945, Puntuacion final: 123.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 138.51949933171272, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 93.31050019722898, Puntuacion final: 95.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 96.9909993254114, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 123.96550011483487, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 157.48750134115107, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 113.93249889661092, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 95.08199932728894, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 98.08449982618913, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 145.06600032397546, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 103.90250176051632, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 150.8174997838214, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 105.09950045449659, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 89.10250057128724, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 121.87100054975599, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 145.6354973251, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 176.08049928117543, Puntuacion final: 178.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 108.37799791037105, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 79.28449853358325, Puntuacion final: 81.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 107.30099945981055, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 98.18499975651503, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 151.85349768796004, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 140.78749977587722, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 121.87299815588631, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 111.66849981248379, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 157.85400237736758, Puntuacion final: 162.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 112.57350003020838, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 125.12899918761104, Puntuacion final: 127.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 138.97999890474603, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 107.4930000322056, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 114.512498916185, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 115.85199980257312, Puntuacion final: 117.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 142.69249774236232, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 116.21200128085911, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 114.09899838187266, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 88.18250009813346, Puntuacion final: 90.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 105.60500164190307, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 92.50349893793464, Puntuacion final: 94.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 83.1869993909495, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 109.613000067533, Puntuacion final: 112.0
INFO:final_evaluate_rl:Metricas guardadas en mppo_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/mppo_variants/mppo_big_net/seed_84/best/mppo_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 119.1653
  Puntuacion final promedio:        121.2800
