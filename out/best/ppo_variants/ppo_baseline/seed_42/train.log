INFO:train_ppo_vecnorm:Creando 8 entornos paralelos con VecNormalize...
INFO:train_ppo_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_ppo_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_ppo_vecnorm:Entrenando PPO Fase 1 por 400000 timesteps...
Argumentos de entrenamiento:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 42
  lr: 0.0003
  n_steps: 2048
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  ent_coef: 0.02
  clip_range: 0.2
  vf_coef: 0.5
  max_grad_norm: 0.5
  target_kl: None
  use_sde: False
  sde_sample_freq: -1
  policy_arch: {"pi":[256, 256], "vf":[256, 256]}
  eval_episodes: 50
  best_dir: best/ppo_ablation/ppo_baseline/seed_42/best
  plot_ma_long: 200
  repair_actions_training: True
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 33.3     |
|    ep_rew_mean     | 78.9     |
| time/              |          |
|    fps             | 1722     |
|    iterations      | 1        |
|    time_elapsed    | 9        |
|    total_timesteps | 16384    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 34.1        |
|    ep_rew_mean          | 82.1        |
| time/                   |             |
|    fps                  | 897         |
|    iterations           | 2           |
|    time_elapsed         | 36          |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.033478975 |
|    clip_fraction        | 0.249       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.76       |
|    explained_variance   | -0.228      |
|    learning_rate        | 0.0003      |
|    loss                 | 0.0594      |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.0248     |
|    value_loss           | 0.282       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 34.6        |
|    ep_rew_mean          | 84.7        |
| time/                   |             |
|    fps                  | 743         |
|    iterations           | 3           |
|    time_elapsed         | 66          |
|    total_timesteps      | 49152       |
| train/                  |             |
|    approx_kl            | 0.022121519 |
|    clip_fraction        | 0.279       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.71       |
|    explained_variance   | 0.695       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0229     |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0257     |
|    value_loss           | 0.163       |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 35        |
|    ep_rew_mean          | 89.7      |
| time/                   |           |
|    fps                  | 686       |
|    iterations           | 4         |
|    time_elapsed         | 95        |
|    total_timesteps      | 65536     |
| train/                  |           |
|    approx_kl            | 0.0195195 |
|    clip_fraction        | 0.273     |
|    clip_range           | 0.2       |
|    entropy_loss         | -3.68     |
|    explained_variance   | 0.79      |
|    learning_rate        | 0.0003    |
|    loss                 | -0.0645   |
|    n_updates            | 30        |
|    policy_gradient_loss | -0.0267   |
|    value_loss           | 0.16      |
---------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 35.4       |
|    ep_rew_mean          | 93.1       |
| time/                   |            |
|    fps                  | 668        |
|    iterations           | 5          |
|    time_elapsed         | 122        |
|    total_timesteps      | 81920      |
| train/                  |            |
|    approx_kl            | 0.01840812 |
|    clip_fraction        | 0.269      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.66      |
|    explained_variance   | 0.791      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0242    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.028     |
|    value_loss           | 0.177      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 35.6        |
|    ep_rew_mean          | 101         |
| time/                   |             |
|    fps                  | 657         |
|    iterations           | 6           |
|    time_elapsed         | 149         |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.019389328 |
|    clip_fraction        | 0.27        |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.63       |
|    explained_variance   | 0.807       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0131     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0316     |
|    value_loss           | 0.168       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 36.1        |
|    ep_rew_mean          | 97.3        |
| time/                   |             |
|    fps                  | 641         |
|    iterations           | 7           |
|    time_elapsed         | 178         |
|    total_timesteps      | 114688      |
| train/                  |             |
|    approx_kl            | 0.021191023 |
|    clip_fraction        | 0.291       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.61       |
|    explained_variance   | 0.834       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0612     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0351     |
|    value_loss           | 0.142       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 36.2        |
|    ep_rew_mean          | 101         |
| time/                   |             |
|    fps                  | 637         |
|    iterations           | 8           |
|    time_elapsed         | 205         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.021364748 |
|    clip_fraction        | 0.292       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.58       |
|    explained_variance   | 0.822       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0438     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0381     |
|    value_loss           | 0.153       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 36.8       |
|    ep_rew_mean          | 102        |
| time/                   |            |
|    fps                  | 634        |
|    iterations           | 9          |
|    time_elapsed         | 232        |
|    total_timesteps      | 147456     |
| train/                  |            |
|    approx_kl            | 0.02249506 |
|    clip_fraction        | 0.296      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.56      |
|    explained_variance   | 0.831      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0755    |
|    n_updates            | 80         |
|    policy_gradient_loss | -0.0411    |
|    value_loss           | 0.144      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 36.6        |
|    ep_rew_mean          | 101         |
| time/                   |             |
|    fps                  | 631         |
|    iterations           | 10          |
|    time_elapsed         | 259         |
|    total_timesteps      | 163840      |
| train/                  |             |
|    approx_kl            | 0.024029579 |
|    clip_fraction        | 0.308       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.53       |
|    explained_variance   | 0.834       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0451     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0448     |
|    value_loss           | 0.139       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37          |
|    ep_rew_mean          | 98.9        |
| time/                   |             |
|    fps                  | 627         |
|    iterations           | 11          |
|    time_elapsed         | 287         |
|    total_timesteps      | 180224      |
| train/                  |             |
|    approx_kl            | 0.026427532 |
|    clip_fraction        | 0.322       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.5        |
|    explained_variance   | 0.849       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0845     |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0467     |
|    value_loss           | 0.129       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37          |
|    ep_rew_mean          | 102         |
| time/                   |             |
|    fps                  | 622         |
|    iterations           | 12          |
|    time_elapsed         | 315         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.026680049 |
|    clip_fraction        | 0.325       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.48       |
|    explained_variance   | 0.829       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.108      |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0482     |
|    value_loss           | 0.143       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.4        |
|    ep_rew_mean          | 109         |
| time/                   |             |
|    fps                  | 622         |
|    iterations           | 13          |
|    time_elapsed         | 342         |
|    total_timesteps      | 212992      |
| train/                  |             |
|    approx_kl            | 0.027877735 |
|    clip_fraction        | 0.333       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.47       |
|    explained_variance   | 0.827       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.109      |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.0497     |
|    value_loss           | 0.139       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.5        |
|    ep_rew_mean          | 104         |
| time/                   |             |
|    fps                  | 627         |
|    iterations           | 14          |
|    time_elapsed         | 365         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.029678963 |
|    clip_fraction        | 0.346       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.45       |
|    explained_variance   | 0.822       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0699     |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.0533     |
|    value_loss           | 0.146       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.1        |
|    ep_rew_mean          | 105         |
| time/                   |             |
|    fps                  | 631         |
|    iterations           | 15          |
|    time_elapsed         | 389         |
|    total_timesteps      | 245760      |
| train/                  |             |
|    approx_kl            | 0.030724952 |
|    clip_fraction        | 0.352       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.43       |
|    explained_variance   | 0.827       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0998     |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0556     |
|    value_loss           | 0.136       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.1       |
|    ep_rew_mean          | 104        |
| time/                   |            |
|    fps                  | 635        |
|    iterations           | 16         |
|    time_elapsed         | 412        |
|    total_timesteps      | 262144     |
| train/                  |            |
|    approx_kl            | 0.03055695 |
|    clip_fraction        | 0.355      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.41      |
|    explained_variance   | 0.837      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0919    |
|    n_updates            | 150        |
|    policy_gradient_loss | -0.0551    |
|    value_loss           | 0.129      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.4        |
|    ep_rew_mean          | 104         |
| time/                   |             |
|    fps                  | 638         |
|    iterations           | 17          |
|    time_elapsed         | 436         |
|    total_timesteps      | 278528      |
| train/                  |             |
|    approx_kl            | 0.033049222 |
|    clip_fraction        | 0.358       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.39       |
|    explained_variance   | 0.83        |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0819     |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.0574     |
|    value_loss           | 0.134       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.2       |
|    ep_rew_mean          | 110        |
| time/                   |            |
|    fps                  | 642        |
|    iterations           | 18         |
|    time_elapsed         | 459        |
|    total_timesteps      | 294912     |
| train/                  |            |
|    approx_kl            | 0.03412843 |
|    clip_fraction        | 0.373      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.38      |
|    explained_variance   | 0.84       |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0966    |
|    n_updates            | 170        |
|    policy_gradient_loss | -0.0583    |
|    value_loss           | 0.12       |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.6        |
|    ep_rew_mean          | 103         |
| time/                   |             |
|    fps                  | 645         |
|    iterations           | 19          |
|    time_elapsed         | 482         |
|    total_timesteps      | 311296      |
| train/                  |             |
|    approx_kl            | 0.035245776 |
|    clip_fraction        | 0.378       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.36       |
|    explained_variance   | 0.843       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0805     |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.0606     |
|    value_loss           | 0.123       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.5       |
|    ep_rew_mean          | 110        |
| time/                   |            |
|    fps                  | 647        |
|    iterations           | 20         |
|    time_elapsed         | 505        |
|    total_timesteps      | 327680     |
| train/                  |            |
|    approx_kl            | 0.03567894 |
|    clip_fraction        | 0.378      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.35      |
|    explained_variance   | 0.836      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0955    |
|    n_updates            | 190        |
|    policy_gradient_loss | -0.0602    |
|    value_loss           | 0.121      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.6        |
|    ep_rew_mean          | 110         |
| time/                   |             |
|    fps                  | 650         |
|    iterations           | 21          |
|    time_elapsed         | 528         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.037684597 |
|    clip_fraction        | 0.393       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.33       |
|    explained_variance   | 0.837       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0951     |
|    n_updates            | 200         |
|    policy_gradient_loss | -0.0622     |
|    value_loss           | 0.127       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.2        |
|    ep_rew_mean          | 106         |
| time/                   |             |
|    fps                  | 652         |
|    iterations           | 22          |
|    time_elapsed         | 552         |
|    total_timesteps      | 360448      |
| train/                  |             |
|    approx_kl            | 0.038628962 |
|    clip_fraction        | 0.4         |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.32       |
|    explained_variance   | 0.852       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.12       |
|    n_updates            | 210         |
|    policy_gradient_loss | -0.0634     |
|    value_loss           | 0.116       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.5        |
|    ep_rew_mean          | 108         |
| time/                   |             |
|    fps                  | 654         |
|    iterations           | 23          |
|    time_elapsed         | 575         |
|    total_timesteps      | 376832      |
| train/                  |             |
|    approx_kl            | 0.039668433 |
|    clip_fraction        | 0.403       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.3        |
|    explained_variance   | 0.828       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.108      |
|    n_updates            | 220         |
|    policy_gradient_loss | -0.0646     |
|    value_loss           | 0.121       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.5        |
|    ep_rew_mean          | 107         |
| time/                   |             |
|    fps                  | 656         |
|    iterations           | 24          |
|    time_elapsed         | 598         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.039279282 |
|    clip_fraction        | 0.403       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.29       |
|    explained_variance   | 0.835       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0833     |
|    n_updates            | 230         |
|    policy_gradient_loss | -0.065      |
|    value_loss           | 0.126       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.8        |
|    ep_rew_mean          | 108         |
| time/                   |             |
|    fps                  | 658         |
|    iterations           | 25          |
|    time_elapsed         | 621         |
|    total_timesteps      | 409600      |
| train/                  |             |
|    approx_kl            | 0.040980823 |
|    clip_fraction        | 0.418       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.29       |
|    explained_variance   | 0.848       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.106      |
|    n_updates            | 240         |
|    policy_gradient_loss | -0.0655     |
|    value_loss           | 0.114       |
-----------------------------------------
INFO:train_ppo_vecnorm:Entrenando PPO Fase 2 por 400000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 37.4     |
|    ep_rew_mean     | 108      |
| time/              |          |
|    fps             | 1972     |
|    iterations      | 1        |
|    time_elapsed    | 16       |
|    total_timesteps | 32768    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.5        |
|    ep_rew_mean          | 108         |
| time/                   |             |
|    fps                  | 1002        |
|    iterations           | 2           |
|    time_elapsed         | 65          |
|    total_timesteps      | 65536       |
| train/                  |             |
|    approx_kl            | 0.042183295 |
|    clip_fraction        | 0.413       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.24       |
|    explained_variance   | 0.835       |
|    learning_rate        | 0.0003      |
|    loss                 | 0.00263     |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.0499     |
|    value_loss           | 0.127       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.5       |
|    ep_rew_mean          | 109        |
| time/                   |            |
|    fps                  | 878        |
|    iterations           | 3          |
|    time_elapsed         | 111        |
|    total_timesteps      | 98304      |
| train/                  |            |
|    approx_kl            | 0.04443811 |
|    clip_fraction        | 0.422      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.23      |
|    explained_variance   | 0.849      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0273    |
|    n_updates            | 20         |
|    policy_gradient_loss | -0.0515    |
|    value_loss           | 0.122      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.6        |
|    ep_rew_mean          | 109         |
| time/                   |             |
|    fps                  | 825         |
|    iterations           | 4           |
|    time_elapsed         | 158         |
|    total_timesteps      | 131072      |
| train/                  |             |
|    approx_kl            | 0.045446992 |
|    clip_fraction        | 0.428       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.2        |
|    explained_variance   | 0.853       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0599     |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0523     |
|    value_loss           | 0.121       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.7       |
|    ep_rew_mean          | 107        |
| time/                   |            |
|    fps                  | 770        |
|    iterations           | 5          |
|    time_elapsed         | 212        |
|    total_timesteps      | 163840     |
| train/                  |            |
|    approx_kl            | 0.04655522 |
|    clip_fraction        | 0.435      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.18      |
|    explained_variance   | 0.846      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0916    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0537    |
|    value_loss           | 0.129      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 38          |
|    ep_rew_mean          | 112         |
| time/                   |             |
|    fps                  | 724         |
|    iterations           | 6           |
|    time_elapsed         | 271         |
|    total_timesteps      | 196608      |
| train/                  |             |
|    approx_kl            | 0.047886893 |
|    clip_fraction        | 0.44        |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.16       |
|    explained_variance   | 0.854       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0497     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0532     |
|    value_loss           | 0.12        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.9        |
|    ep_rew_mean          | 114         |
| time/                   |             |
|    fps                  | 696         |
|    iterations           | 7           |
|    time_elapsed         | 329         |
|    total_timesteps      | 229376      |
| train/                  |             |
|    approx_kl            | 0.047668323 |
|    clip_fraction        | 0.439       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.12       |
|    explained_variance   | 0.846       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0605     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.054      |
|    value_loss           | 0.124       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.8        |
|    ep_rew_mean          | 111         |
| time/                   |             |
|    fps                  | 664         |
|    iterations           | 8           |
|    time_elapsed         | 394         |
|    total_timesteps      | 262144      |
| train/                  |             |
|    approx_kl            | 0.049742214 |
|    clip_fraction        | 0.446       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.09       |
|    explained_variance   | 0.847       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0363     |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0538     |
|    value_loss           | 0.128       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 38          |
|    ep_rew_mean          | 107         |
| time/                   |             |
|    fps                  | 644         |
|    iterations           | 9           |
|    time_elapsed         | 457         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.051128715 |
|    clip_fraction        | 0.453       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.08       |
|    explained_variance   | 0.843       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0594     |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.0547     |
|    value_loss           | 0.124       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.9        |
|    ep_rew_mean          | 115         |
| time/                   |             |
|    fps                  | 576         |
|    iterations           | 10          |
|    time_elapsed         | 568         |
|    total_timesteps      | 327680      |
| train/                  |             |
|    approx_kl            | 0.051307656 |
|    clip_fraction        | 0.45        |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.05       |
|    explained_variance   | 0.849       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0921     |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.055      |
|    value_loss           | 0.12        |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.9       |
|    ep_rew_mean          | 114        |
| time/                   |            |
|    fps                  | 567        |
|    iterations           | 11         |
|    time_elapsed         | 634        |
|    total_timesteps      | 360448     |
| train/                  |            |
|    approx_kl            | 0.05189451 |
|    clip_fraction        | 0.452      |
|    clip_range           | 0.2        |
|    entropy_loss         | -3.02      |
|    explained_variance   | 0.846      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0335    |
|    n_updates            | 100        |
|    policy_gradient_loss | -0.0548    |
|    value_loss           | 0.128      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.9        |
|    ep_rew_mean          | 110         |
| time/                   |             |
|    fps                  | 554         |
|    iterations           | 12          |
|    time_elapsed         | 709         |
|    total_timesteps      | 393216      |
| train/                  |             |
|    approx_kl            | 0.054661103 |
|    clip_fraction        | 0.464       |
|    clip_range           | 0.2         |
|    entropy_loss         | -3.01       |
|    explained_variance   | 0.849       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0656     |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0574     |
|    value_loss           | 0.123       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 37.8        |
|    ep_rew_mean          | 114         |
| time/                   |             |
|    fps                  | 556         |
|    iterations           | 13          |
|    time_elapsed         | 764         |
|    total_timesteps      | 425984      |
| train/                  |             |
|    approx_kl            | 0.052701756 |
|    clip_fraction        | 0.458       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.98       |
|    explained_variance   | 0.855       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0707     |
|    n_updates            | 120         |
|    policy_gradient_loss | -0.056      |
|    value_loss           | 0.117       |
-----------------------------------------
INFO:train_ppo_vecnorm:Entrenando PPO Fase 3 por 300000 timesteps...
Using cpu device
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 37.6     |
|    ep_rew_mean     | 109      |
| time/              |          |
|    fps             | 1589     |
|    iterations      | 1        |
|    time_elapsed    | 30       |
|    total_timesteps | 49152    |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 38          |
|    ep_rew_mean          | 112         |
| time/                   |             |
|    fps                  | 811         |
|    iterations           | 2           |
|    time_elapsed         | 121         |
|    total_timesteps      | 98304       |
| train/                  |             |
|    approx_kl            | 0.054080885 |
|    clip_fraction        | 0.462       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.94       |
|    explained_variance   | 0.851       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0043     |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.046      |
|    value_loss           | 0.126       |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.9       |
|    ep_rew_mean          | 114        |
| time/                   |            |
|    fps                  | 700        |
|    iterations           | 3          |
|    time_elapsed         | 210        |
|    total_timesteps      | 147456     |
| train/                  |            |
|    approx_kl            | 0.05254011 |
|    clip_fraction        | 0.459      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.91      |
|    explained_variance   | 0.858      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0368    |
|    n_updates            | 20         |
|    policy_gradient_loss | -0.0457    |
|    value_loss           | 0.117      |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 38.1       |
|    ep_rew_mean          | 114        |
| time/                   |            |
|    fps                  | 673        |
|    iterations           | 4          |
|    time_elapsed         | 292        |
|    total_timesteps      | 196608     |
| train/                  |            |
|    approx_kl            | 0.05452922 |
|    clip_fraction        | 0.465      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.88      |
|    explained_variance   | 0.859      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0469    |
|    n_updates            | 30         |
|    policy_gradient_loss | -0.0463    |
|    value_loss           | 0.12       |
----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 37.9       |
|    ep_rew_mean          | 111        |
| time/                   |            |
|    fps                  | 654        |
|    iterations           | 5          |
|    time_elapsed         | 375        |
|    total_timesteps      | 245760     |
| train/                  |            |
|    approx_kl            | 0.05558959 |
|    clip_fraction        | 0.467      |
|    clip_range           | 0.2        |
|    entropy_loss         | -2.85      |
|    explained_variance   | 0.861      |
|    learning_rate        | 0.0003     |
|    loss                 | -0.0128    |
|    n_updates            | 40         |
|    policy_gradient_loss | -0.0469    |
|    value_loss           | 0.118      |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 38          |
|    ep_rew_mean          | 115         |
| time/                   |             |
|    fps                  | 638         |
|    iterations           | 6           |
|    time_elapsed         | 461         |
|    total_timesteps      | 294912      |
| train/                  |             |
|    approx_kl            | 0.057102155 |
|    clip_fraction        | 0.474       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.82       |
|    explained_variance   | 0.859       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0284     |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0475     |
|    value_loss           | 0.123       |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 38          |
|    ep_rew_mean          | 114         |
| time/                   |             |
|    fps                  | 622         |
|    iterations           | 7           |
|    time_elapsed         | 552         |
|    total_timesteps      | 344064      |
| train/                  |             |
|    approx_kl            | 0.056763303 |
|    clip_fraction        | 0.472       |
|    clip_range           | 0.2         |
|    entropy_loss         | -2.79       |
|    explained_variance   | 0.848       |
|    learning_rate        | 0.0003      |
|    loss                 | -0.0588     |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.048      |
|    value_loss           | 0.129       |
-----------------------------------------
INFO:train_ppo_vecnorm:Modelo guardado en best/ppo_ablation/ppo_baseline/seed_42/best/ppo_yahtzee_vecnorm_final y estadisticas de normalizacion en best/ppo_ablation/ppo_baseline/seed_42/best/ppo_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/ppo_ablation/ppo_baseline/seed_42/best/ppo_yahtzee_vecnorm_final, stats=best/ppo_ablation/ppo_baseline/seed_42/best/ppo_vecnorm_stats.pkl, algo=ppo
INFO:final_evaluate_rl:Cargando modelo: best/ppo_ablation/ppo_baseline/seed_42/best/ppo_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: ppo
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 105.26899949461222, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 126.03949910728261, Puntuacion final: 128.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 154.4064995389199, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 168.82200164039386, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 155.35750037262915, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 104.77299896010663, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 92.89849919918925, Puntuacion final: 95.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 150.91000241436996, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 154.84549914865056, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 132.0925023718737, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 87.4690010966151, Puntuacion final: 89.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 99.85050052916631, Puntuacion final: 102.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 109.46000082348473, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 161.80949763656827, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 129.79000044206623, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 149.2100012623705, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 163.48299962864257, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 107.12300132779637, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 95.9765005891677, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 132.83649961842457, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 89.97450091107748, Puntuacion final: 92.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 157.80900081817526, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 112.26200119091664, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 107.82400024984963, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 95.44550078990869, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 175.0990017101285, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 147.02800089551602, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 120.12300060119014, Puntuacion final: 122.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 68.52699866890907, Puntuacion final: 70.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 127.83700000017416, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 105.68699944997206, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 96.85500119486824, Puntuacion final: 100.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 168.10899855941534, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 135.69050109595992, Puntuacion final: 138.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 152.70750014018267, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 108.07300117483828, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 178.83099859405775, Puntuacion final: 181.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 93.86799923446961, Puntuacion final: 97.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 112.85649923770688, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 97.2659986144863, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 109.4375022627064, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 123.81349982821848, Puntuacion final: 127.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 83.42949968914036, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 116.54700134322047, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 75.2934994334355, Puntuacion final: 77.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 139.42399810114875, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 133.83800097793574, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 90.85199949657544, Puntuacion final: 94.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 140.52150015439838, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 115.89200080512092, Puntuacion final: 118.0
INFO:final_evaluate_rl:Metricas guardadas en ppo_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/ppo_ablation/ppo_baseline/seed_42/best/ppo_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 123.2669
  Puntuacion final promedio:        125.4800
