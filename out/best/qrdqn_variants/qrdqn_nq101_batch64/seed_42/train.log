INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 42
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 101
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 33.5     |
|    ep_rew_mean      | 69       |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3943     |
|    time_elapsed     | 0        |
|    total_timesteps  | 272      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 36.7     |
|    ep_rew_mean      | 140      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8164     |
|    fps              | 91       |
|    time_elapsed     | 3260     |
|    total_timesteps  | 299840   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.26     |
|    n_updates        | 74958    |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_yahtzee_vecnorm_model, stats=best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_yahtzee_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 179.25049967714585, Puntuacion final: 181.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 191.69999849895248, Puntuacion final: 194.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 110.68499799404526, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 151.6670012329705, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 178.13300054584397, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 151.65199772210326, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 174.92649863823317, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 128.41200091014616, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 204.99300144414883, Puntuacion final: 207.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 173.59699864848517, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 117.3605000335956, Puntuacion final: 119.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 80.89099851436913, Puntuacion final: 84.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 170.1045003994368, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 107.85700075945351, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 121.85549981181975, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 108.6669994428521, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 167.4219993161969, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 145.84550149715506, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 108.63900060253218, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 156.85450057353592, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 89.62449976452626, Puntuacion final: 91.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 101.76200053485809, Puntuacion final: 104.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 140.81000133487396, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 128.73450025869533, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 60.08549997815862, Puntuacion final: 62.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 176.8970000281697, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 141.34350065211765, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 178.9520014974405, Puntuacion final: 181.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 172.8590000825934, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 147.33450099558104, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 179.29249970032834, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 167.32350047305226, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 118.16949987295084, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 181.77849936159328, Puntuacion final: 185.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 153.9295010654023, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 186.01249684975483, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 149.3395026809303, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 171.8374987716088, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 157.73350159125403, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 154.01150300732115, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 170.84049949096516, Puntuacion final: 174.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 167.1020001785364, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 142.64150050200988, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 118.06950018799398, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 119.14050124096684, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 141.8335000104271, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 131.42899987165583, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 153.24750117980875, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 177.26750112819718, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 111.37049984396435, Puntuacion final: 114.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_nq101_batch64/seed_42/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 146.4257
  Puntuacion final promedio:        148.6600
