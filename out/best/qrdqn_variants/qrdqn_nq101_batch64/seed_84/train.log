INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 84
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 101
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 32.3     |
|    ep_rew_mean      | 68.2     |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3761     |
|    time_elapsed     | 0        |
|    total_timesteps  | 272      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 37.2     |
|    ep_rew_mean      | 144      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8164     |
|    fps              | 94       |
|    time_elapsed     | 3168     |
|    total_timesteps  | 299912   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 1.79     |
|    n_updates        | 74976    |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_yahtzee_vecnorm_model, stats=best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_yahtzee_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 137.7299997685477, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 136.8390017262427, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 160.49949916184414, Puntuacion final: 162.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 172.87449976359494, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 161.09199708740925, Puntuacion final: 163.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 166.788496129564, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 205.20799875661032, Puntuacion final: 207.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 139.61599945649505, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 198.1650016909698, Puntuacion final: 200.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 179.7050008479273, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 152.8370022153831, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 201.78350200480781, Puntuacion final: 205.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 173.8375002988614, Puntuacion final: 178.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 168.7309999592835, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 200.77750147192273, Puntuacion final: 203.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 122.06400188314728, Puntuacion final: 124.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 123.52899969695136, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 174.8299997090944, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 196.28599935758393, Puntuacion final: 199.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 132.24149829521775, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 163.7374991257675, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 173.80050113331527, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 157.45550094661303, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 135.2154997010948, Puntuacion final: 137.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 120.04699921992142, Puntuacion final: 122.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 152.820000132313, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 140.0120013653068, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 186.12699947110377, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 140.1335006968584, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 138.83650165051222, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 183.00450217328034, Puntuacion final: 185.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 112.04650044487789, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 113.92699839710258, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 150.83550075412495, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 168.91099804779515, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 100.45800052920822, Puntuacion final: 103.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 170.41799824568443, Puntuacion final: 173.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 180.99400091124699, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 174.09750068327412, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 134.13049909780966, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 154.78100096154958, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 163.03250217810273, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 127.04849903099239, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 166.60750102356542, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 199.9210011565592, Puntuacion final: 202.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 153.4464988723048, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 108.34200108703226, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 134.3185003674589, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 172.5260008284822, Puntuacion final: 174.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 179.49049893883057, Puntuacion final: 182.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_nq101_batch64/seed_84/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 157.2391
  Puntuacion final promedio:        159.4400
