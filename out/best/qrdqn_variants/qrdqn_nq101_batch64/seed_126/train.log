INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 101
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 30.5     |
|    ep_rew_mean      | 49       |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3792     |
|    time_elapsed     | 0        |
|    total_timesteps  | 264      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 37.9     |
|    ep_rew_mean      | 132      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 7932     |
|    fps              | 93       |
|    time_elapsed     | 3205     |
|    total_timesteps  | 299856   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 2        |
|    n_updates        | 74962    |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_yahtzee_vecnorm_model, stats=best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_yahtzee_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 206.26600150531158, Puntuacion final: 208.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 111.69900050386786, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 153.17500040843152, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 108.55100022477563, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 114.25800154660828, Puntuacion final: 116.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 121.57300059171394, Puntuacion final: 123.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 84.87249968899414, Puntuacion final: 88.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 106.84699867625022, Puntuacion final: 109.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 168.30549825308844, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 156.81700129783712, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 128.3445028217975, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 155.70499851508066, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 81.88050088728778, Puntuacion final: 85.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 113.11849856306799, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 150.23050060367677, Puntuacion final: 152.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 99.45499834883958, Puntuacion final: 102.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 171.02649970399216, Puntuacion final: 173.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 141.02750078984536, Puntuacion final: 143.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 95.82499863882549, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 136.82750020420644, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 177.82149995991495, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 72.85999842081219, Puntuacion final: 77.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 116.7715014196001, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 150.93849954614416, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 136.7414991086116, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 108.3480005026795, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 144.7965011105407, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 98.3739998077508, Puntuacion final: 101.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 107.37499931856291, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 111.34950082330033, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 138.13600179110654, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 108.64549913071096, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 105.69400014937855, Puntuacion final: 107.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 136.1269986166153, Puntuacion final: 138.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 137.30299901636317, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 141.91799966432154, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 171.30450044432655, Puntuacion final: 174.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 119.07099981681677, Puntuacion final: 121.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 130.2119995096, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 132.48850108799525, Puntuacion final: 134.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 152.3444995114114, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 167.79999930161284, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 136.80300032399828, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 158.69399884878658, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 167.0225001258077, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 164.6835018512793, Puntuacion final: 166.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 153.10400178609416, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 81.32700002728961, Puntuacion final: 84.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 145.81749840814155, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 104.74849779903889, Puntuacion final: 107.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_nq101_batch64/seed_126/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 131.6885
  Puntuacion final promedio:        133.9800
