INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 84
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 51
  train_freq: 1
  gradient_steps: 2
  target_update_interval: 30000
  exploration_fraction: 0.45
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 32.3     |
|    ep_rew_mean      | 68.2     |
|    exploration_rate | 0.999    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3559     |
|    time_elapsed     | 0        |
|    total_timesteps  | 272      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 35.3     |
|    ep_rew_mean      | 143      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8528     |
|    fps              | 133      |
|    time_elapsed     | 2252     |
|    total_timesteps  | 299896   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.736    |
|    n_updates        | 149944   |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_yahtzee_vecnorm_final y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_yahtzee_vecnorm_final, stats=best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 165.71149978414178, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 118.33900005323812, Puntuacion final: 120.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 103.73649915627902, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 180.40400024224073, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 133.15350196126383, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 149.23549916152842, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 135.80999951960985, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 211.51499936264008, Puntuacion final: 213.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 110.68849989539012, Puntuacion final: 113.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 165.82000080263242, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 181.8344989871839, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 153.85100040398538, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 127.15150046511553, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 173.83899739570916, Puntuacion final: 177.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 177.7504982468672, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 129.17100051301531, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 169.22549949138192, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 191.44449918228202, Puntuacion final: 193.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 181.2039986527525, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 153.8945018906379, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 108.0009992683772, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 147.81550114788115, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 171.41199715435505, Puntuacion final: 173.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 185.97899856849108, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 152.32949949929025, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 178.19250144134276, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 184.2024986606557, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 176.32150010229088, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 159.0349996224977, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 144.21749919163994, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 191.99749962054193, Puntuacion final: 194.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 106.81949855806306, Puntuacion final: 110.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 123.12850007181987, Puntuacion final: 125.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 165.93050027021673, Puntuacion final: 168.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 163.5355013050139, Puntuacion final: 166.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 140.32750178256538, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 170.5500001560431, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 204.50850086507853, Puntuacion final: 207.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 188.6209990202915, Puntuacion final: 191.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 126.65099892904982, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 208.62300233740825, Puntuacion final: 211.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 180.6984981361311, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 147.42899991275044, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 129.04400019953027, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 182.52750018471852, Puntuacion final: 185.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 127.1444997076178, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 155.2269991079811, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 152.44250049837865, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 128.74599925335497, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 118.73799974855501, Puntuacion final: 121.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_84/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 156.6795
  Puntuacion final promedio:        158.7600
