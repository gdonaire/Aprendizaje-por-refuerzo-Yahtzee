INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 51
  train_freq: 1
  gradient_steps: 2
  target_update_interval: 30000
  exploration_fraction: 0.45
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 30.5     |
|    ep_rew_mean      | 49       |
|    exploration_rate | 0.999    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3345     |
|    time_elapsed     | 0        |
|    total_timesteps  | 264      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 36.1     |
|    ep_rew_mean      | 146      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8348     |
|    fps              | 99       |
|    time_elapsed     | 3028     |
|    total_timesteps  | 299936   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.87     |
|    n_updates        | 149964   |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_yahtzee_vecnorm_model y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_yahtzee_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_yahtzee_vecnorm_model, stats=best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_yahtzee_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_yahtzee_vecnorm_model
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 147.3179996223189, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 145.1569987499388, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 153.72250257071573, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 143.82699882105226, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 110.24549990193918, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 129.05099930462893, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 154.36249966872856, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 128.8530005046632, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 173.3025014079176, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 143.94150255486602, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 145.1279985436704, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 166.62000086018816, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 162.42699760152027, Puntuacion final: 164.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 167.7305005514063, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 136.729500282323, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 146.34049927687738, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 106.2670018322533, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 142.13099961879198, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 144.1465006469516, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 124.33949958172161, Puntuacion final: 127.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 186.2899978160276, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 127.33349979063496, Puntuacion final: 129.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 180.1419996265322, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 104.28049935365561, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 121.46549717016751, Puntuacion final: 123.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 178.3384978612885, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 194.1174984429963, Puntuacion final: 197.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 108.87699881719891, Puntuacion final: 111.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 149.8440018640831, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 150.1054978700122, Puntuacion final: 152.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 185.05899862060323, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 113.37350204354152, Puntuacion final: 115.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 192.59250186779536, Puntuacion final: 195.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 151.27700018958421, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 159.77600152074592, Puntuacion final: 162.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 130.03349918033928, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 151.4030018770718, Puntuacion final: 153.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 100.39399940014118, Puntuacion final: 102.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 149.0670003183186, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 172.78199921897613, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 145.92949705792125, Puntuacion final: 148.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 158.9114985136548, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 148.21600020700134, Puntuacion final: 150.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 196.58150087931426, Puntuacion final: 199.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 133.20900073018856, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 128.06000055233017, Puntuacion final: 130.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 168.40699779428542, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 129.0609997594729, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 203.80749908427242, Puntuacion final: 207.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 134.80050141573884, Puntuacion final: 137.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_target_slow_grad_more/seed_126/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 148.5035
  Puntuacion final promedio:        150.6200
