INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 84
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 51
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_baseline/seed_84/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 32.3     |
|    ep_rew_mean      | 68.2     |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 3765     |
|    time_elapsed     | 0        |
|    total_timesteps  | 272      |
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 37.3     |
|    ep_rew_mean      | 143      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8064     |
|    fps              | 249      |
|    time_elapsed     | 1202     |
|    total_timesteps  | 299976   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.947    |
|    n_updates        | 74992    |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_yahtzee_vecnorm_final y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_yahtzee_vecnorm_final, stats=best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 137.7400006861426, Puntuacion final: 140.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 140.65500066120876, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 130.23949989827815, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 142.42150137433782, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 182.10599983856082, Puntuacion final: 184.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 93.0490011345828, Puntuacion final: 95.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 180.58799817075487, Puntuacion final: 183.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 162.29000083752908, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 140.83299983479083, Puntuacion final: 144.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 138.52499862445984, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 153.32800001930445, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 154.429500426515, Puntuacion final: 156.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 154.84750132268528, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 187.68199931341223, Puntuacion final: 189.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 97.0799994324334, Puntuacion final: 99.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 153.01549987052567, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 184.77999919466674, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 184.283999230247, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 205.5695001016138, Puntuacion final: 207.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 168.97300200926838, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 104.84499933570623, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 179.91199954942567, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 167.8005023089936, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 155.6349987227586, Puntuacion final: 157.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 183.76049952604808, Puntuacion final: 187.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 189.53150138212368, Puntuacion final: 192.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 173.80100230599055, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 207.38099901290843, Puntuacion final: 209.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 153.100499315653, Puntuacion final: 155.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 193.08950096042827, Puntuacion final: 195.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 124.71350065374281, Puntuacion final: 127.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 137.2565024147043, Puntuacion final: 139.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 110.7919985614717, Puntuacion final: 114.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 103.36349880322814, Puntuacion final: 106.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 192.9945015470148, Puntuacion final: 195.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 156.33749938884284, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 179.49449862033362, Puntuacion final: 182.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 178.69199943030253, Puntuacion final: 180.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 129.90999910910614, Puntuacion final: 132.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 177.38749806792475, Puntuacion final: 179.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 208.16750242561102, Puntuacion final: 210.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 183.01950160093838, Puntuacion final: 185.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 140.23349941312335, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 184.7915023858659, Puntuacion final: 189.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 179.70500092196744, Puntuacion final: 181.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 152.3350010580616, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 160.08600228792056, Puntuacion final: 162.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 157.84499997622333, Puntuacion final: 160.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 168.8060016426607, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 105.86300036776811, Puntuacion final: 109.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_baseline/seed_84/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 158.6617
  Puntuacion final promedio:        160.8200
