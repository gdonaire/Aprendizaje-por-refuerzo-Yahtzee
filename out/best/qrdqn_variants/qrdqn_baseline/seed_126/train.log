INFO:train_qrdqn_vecnorm:Creando 8 entornos paralelos...
INFO:train_qrdqn_vecnorm:Activando wrapper de reparacion de acciones invalidas durante TRAINING...
INFO:train_qrdqn_vecnorm:Activando wrapper de recompensa REAL por episodio (antes de VecNormalize)...
INFO:train_qrdqn_vecnorm:Aplicando VecNormalize (obs y reward normalizados)...
INFO:train_qrdqn_vecnorm:Entrenando QRDQN Fase 1 por 400000 timesteps...
Argumentos de entrenamiento QRDQN:
  timesteps: 400000
  timesteps2: 400000
  timesteps3: 300000
  n_envs: 8
  seed: 126
  lr: 0.0001
  buffer_size: 1000000
  learning_starts: 10000
  batch_size: 64
  gamma: 0.99
  n_steps: 3
  n_quantiles: 51
  train_freq: 1
  gradient_steps: 1
  target_update_interval: 10000
  exploration_fraction: 0.3
  exploration_initial_eps: 1.0
  exploration_final_eps: 0.05
  repair_actions_training: True
  eval_episodes: 50
  best_dir: best/qrdqn_variants/qrdqn_baseline/seed_126/best
  plot_ma_long: 200
Using cpu device
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 30.5     |
|    ep_rew_mean      | 49       |
|    exploration_rate | 0.998    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 4103     |
|    time_elapsed     | 0        |
|    total_timesteps  | 264      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 37.5     |
|    ep_rew_mean      | 146      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 8084     |
|    fps              | 249      |
|    time_elapsed     | 1199     |
|    total_timesteps  | 299872   |
| train/              |          |
|    learning_rate    | 0.0001   |
|    loss             | 0.897    |
|    n_updates        | 74966    |
----------------------------------
INFO:train_qrdqn_vecnorm:Modelo guardado en best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_yahtzee_vecnorm_final y estadisticas de normalizacion en best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_vecnorm_stats.pkl
INFO:final_evaluate_rl:Autodeteccion: modelo=best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_yahtzee_vecnorm_final, stats=best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_vecnorm_stats.pkl, algo=qrdqn
INFO:final_evaluate_rl:Cargando modelo: best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_yahtzee_vecnorm_final
INFO:final_evaluate_rl:Algo detectado/forzado: qrdqn
INFO:final_evaluate_rl:Evaluando el modelo con recompensas SIN normalizar(evaluacion segura)...
INFO:final_evaluate_rl:Episode 1: Recompensa del episodio: 165.31700031715445, Puntuacion final: 167.0
INFO:final_evaluate_rl:Episode 2: Recompensa del episodio: 129.42749884910882, Puntuacion final: 131.0
INFO:final_evaluate_rl:Episode 3: Recompensa del episodio: 152.00050118810032, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 4: Recompensa del episodio: 142.42900126543827, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 5: Recompensa del episodio: 139.93349975673482, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 6: Recompensa del episodio: 165.0170024954714, Puntuacion final: 167.0
INFO:final_evaluate_rl:Episode 7: Recompensa del episodio: 131.1264977804385, Puntuacion final: 133.0
INFO:final_evaluate_rl:Episode 8: Recompensa del episodio: 188.4845011663856, Puntuacion final: 190.0
INFO:final_evaluate_rl:Episode 9: Recompensa del episodio: 149.61949910933618, Puntuacion final: 151.0
INFO:final_evaluate_rl:Episode 10: Recompensa del episodio: 173.81049936905038, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 11: Recompensa del episodio: 144.70449783623917, Puntuacion final: 147.0
INFO:final_evaluate_rl:Episode 12: Recompensa del episodio: 102.96150021918584, Puntuacion final: 105.0
INFO:final_evaluate_rl:Episode 13: Recompensa del episodio: 81.88999723922461, Puntuacion final: 83.0
INFO:final_evaluate_rl:Episode 14: Recompensa del episodio: 158.70350110298023, Puntuacion final: 161.0
INFO:final_evaluate_rl:Episode 15: Recompensa del episodio: 162.99850254622288, Puntuacion final: 165.0
INFO:final_evaluate_rl:Episode 16: Recompensa del episodio: 101.15499904262833, Puntuacion final: 103.0
INFO:final_evaluate_rl:Episode 17: Recompensa del episodio: 204.4730011864449, Puntuacion final: 206.0
INFO:final_evaluate_rl:Episode 18: Recompensa del episodio: 131.87149878940545, Puntuacion final: 135.0
INFO:final_evaluate_rl:Episode 19: Recompensa del episodio: 119.83449948765337, Puntuacion final: 122.0
INFO:final_evaluate_rl:Episode 20: Recompensa del episodio: 203.39349819434574, Puntuacion final: 206.0
INFO:final_evaluate_rl:Episode 21: Recompensa del episodio: 143.44950026250444, Puntuacion final: 145.0
INFO:final_evaluate_rl:Episode 22: Recompensa del episodio: 109.95650086115347, Puntuacion final: 112.0
INFO:final_evaluate_rl:Episode 23: Recompensa del episodio: 156.6055014024023, Puntuacion final: 159.0
INFO:final_evaluate_rl:Episode 24: Recompensa del episodio: 96.75449990155175, Puntuacion final: 98.0
INFO:final_evaluate_rl:Episode 25: Recompensa del episodio: 166.82300107961055, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 26: Recompensa del episodio: 116.17350094317226, Puntuacion final: 118.0
INFO:final_evaluate_rl:Episode 27: Recompensa del episodio: 166.90250064712018, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 28: Recompensa del episodio: 140.54850140452618, Puntuacion final: 142.0
INFO:final_evaluate_rl:Episode 29: Recompensa del episodio: 142.82800136879086, Puntuacion final: 146.0
INFO:final_evaluate_rl:Episode 30: Recompensa del episodio: 169.99849887558958, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 31: Recompensa del episodio: 146.95399974333122, Puntuacion final: 149.0
INFO:final_evaluate_rl:Episode 32: Recompensa del episodio: 152.2270004680613, Puntuacion final: 154.0
INFO:final_evaluate_rl:Episode 33: Recompensa del episodio: 167.12599882530048, Puntuacion final: 169.0
INFO:final_evaluate_rl:Episode 34: Recompensa del episodio: 174.0094980491558, Puntuacion final: 176.0
INFO:final_evaluate_rl:Episode 35: Recompensa del episodio: 186.09800349234138, Puntuacion final: 188.0
INFO:final_evaluate_rl:Episode 36: Recompensa del episodio: 160.34200071706437, Puntuacion final: 163.0
INFO:final_evaluate_rl:Episode 37: Recompensa del episodio: 134.01850164745701, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 38: Recompensa del episodio: 123.76900099311024, Puntuacion final: 126.0
INFO:final_evaluate_rl:Episode 39: Recompensa del episodio: 169.30849992437288, Puntuacion final: 171.0
INFO:final_evaluate_rl:Episode 40: Recompensa del episodio: 167.72199805814307, Puntuacion final: 170.0
INFO:final_evaluate_rl:Episode 41: Recompensa del episodio: 184.50700141536072, Puntuacion final: 186.0
INFO:final_evaluate_rl:Episode 42: Recompensa del episodio: 167.79900235839887, Puntuacion final: 172.0
INFO:final_evaluate_rl:Episode 43: Recompensa del episodio: 139.25600163661875, Puntuacion final: 141.0
INFO:final_evaluate_rl:Episode 44: Recompensa del episodio: 156.2135001004208, Puntuacion final: 158.0
INFO:final_evaluate_rl:Episode 45: Recompensa del episodio: 134.1665034215548, Puntuacion final: 136.0
INFO:final_evaluate_rl:Episode 46: Recompensa del episodio: 160.34349875344196, Puntuacion final: 163.0
INFO:final_evaluate_rl:Episode 47: Recompensa del episodio: 173.1205013548024, Puntuacion final: 175.0
INFO:final_evaluate_rl:Episode 48: Recompensa del episodio: 106.2429995292332, Puntuacion final: 108.0
INFO:final_evaluate_rl:Episode 49: Recompensa del episodio: 93.34250027895905, Puntuacion final: 96.0
INFO:final_evaluate_rl:Episode 50: Recompensa del episodio: 142.35749896481866, Puntuacion final: 144.0
INFO:final_evaluate_rl:Metricas guardadas en qrdqn_vecnorm_final_evaluation_metrics.txt
Grafica guardada en best/qrdqn_variants/qrdqn_baseline/seed_126/best/qrdqn_vecnorm_reward_evolution.png

Resumen:
  Recompensa media (sin normalizar): 147.9623
  Puntuacion final promedio:        150.0200
